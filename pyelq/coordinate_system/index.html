
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This repository contains the Python Emission Localization and Quantification software we call pyELQ. It is code used for gas dispersion modelling, in particular methane emissions detection, localization and quantification.">
      
      
        <meta name="author" content="pyELQ">
      
      
      
        <link rel="prev" href="../component/source_model/">
      
      
        <link rel="next" href="../data_access/data_access/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Coordinate System - pyELQ Python Emission Localization and Quantification</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


  
  
    
    
      
    
    
  
  
  <style>:root{.md-tag.md-tag--pipelines{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M128%2072a24%2024%200%201%201%200%2048%2024%2024%200%201%201%200-48m32%2097.3c28.3-12.3%2048-40.5%2048-73.3%200-44.2-35.8-80-80-80S48%2051.8%2048%2096c0%2032.8%2019.7%2061%2048%2073.3V224H32c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v54.7c-28.3%2012.3-48%2040.5-48%2073.3%200%2044.2%2035.8%2080%2080%2080s80-35.8%2080-80c0-32.8-19.7-61-48-73.3V288h256c17.7%200%2032-14.3%2032-32s-14.3-32-32-32h-64v-54.7c28.3-12.3%2048-40.5%2048-73.3%200-44.2-35.8-80-80-80s-80%2035.8-80%2080c0%2032.8%2019.7%2061%2048%2073.3V224H160zM488%2096a24%2024%200%201%201%2048%200%2024%2024%200%201%201-48%200M320%20392a24%2024%200%201%201%200%2048%2024%2024%200%201%201%200-48%22/%3E%3C/svg%3E');}}</style>

    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#coordinate-system" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="pyELQ Python Emission Localization and Quantification" class="md-header__button md-logo" aria-label="pyELQ Python Emission Localization and Quantification" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyELQ Python Emission Localization and Quantification
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Coordinate System
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/sede-open/pyELQ" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    pyELQ
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../component/component/" class="md-tabs__link">
          
  
  
    
  
  pyELQ User Guide

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="pyELQ Python Emission Localization and Quantification" class="md-nav__button md-logo" aria-label="pyELQ Python Emission Localization and Quantification" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    pyELQ Python Emission Localization and Quantification
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sede-open/pyELQ" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    pyELQ
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    pyELQ User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            pyELQ User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Components
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../component/component/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../component/background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Background
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../component/error_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Error Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../component/offset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Offset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../component/source_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Source Model
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Coordinate System
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Coordinate System
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyelq.coordinate_system" class="md-nav__link">
    <span class="md-ellipsis">
      coordinate_system
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate" class="md-nav__link">
    <span class="md-ellipsis">
      Coordinate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Coordinate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.nof_observations" class="md-nav__link">
    <span class="md-ellipsis">
      nof_observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.from_array" class="md-nav__link">
    <span class="md-ellipsis">
      from_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.to_array" class="md-nav__link">
    <span class="md-ellipsis">
      to_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.to_lla" class="md-nav__link">
    <span class="md-ellipsis">
      to_lla
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.to_ecef" class="md-nav__link">
    <span class="md-ellipsis">
      to_ecef
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.to_enu" class="md-nav__link">
    <span class="md-ellipsis">
      to_enu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.to_object_type" class="md-nav__link">
    <span class="md-ellipsis">
      to_object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.interpolate" class="md-nav__link">
    <span class="md-ellipsis">
      interpolate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.make_grid" class="md-nav__link">
    <span class="md-ellipsis">
      make_grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.create_tree" class="md-nav__link">
    <span class="md-ellipsis">
      create_tree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA" class="md-nav__link">
    <span class="md-ellipsis">
      LLA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LLA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA.nof_observations" class="md-nav__link">
    <span class="md-ellipsis">
      nof_observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA.from_array" class="md-nav__link">
    <span class="md-ellipsis">
      from_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA.to_array" class="md-nav__link">
    <span class="md-ellipsis">
      to_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA.to_lla" class="md-nav__link">
    <span class="md-ellipsis">
      to_lla
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA.to_ecef" class="md-nav__link">
    <span class="md-ellipsis">
      to_ecef
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA.to_enu" class="md-nav__link">
    <span class="md-ellipsis">
      to_enu
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU" class="md-nav__link">
    <span class="md-ellipsis">
      ENU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ENU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU.nof_observations" class="md-nav__link">
    <span class="md-ellipsis">
      nof_observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU.from_array" class="md-nav__link">
    <span class="md-ellipsis">
      from_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU.to_array" class="md-nav__link">
    <span class="md-ellipsis">
      to_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU.to_enu" class="md-nav__link">
    <span class="md-ellipsis">
      to_enu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU.to_lla" class="md-nav__link">
    <span class="md-ellipsis">
      to_lla
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU.to_ecef" class="md-nav__link">
    <span class="md-ellipsis">
      to_ecef
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF" class="md-nav__link">
    <span class="md-ellipsis">
      ECEF
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ECEF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF.nof_observations" class="md-nav__link">
    <span class="md-ellipsis">
      nof_observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF.from_array" class="md-nav__link">
    <span class="md-ellipsis">
      from_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF.to_array" class="md-nav__link">
    <span class="md-ellipsis">
      to_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF.to_ecef" class="md-nav__link">
    <span class="md-ellipsis">
      to_ecef
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF.to_lla" class="md-nav__link">
    <span class="md-ellipsis">
      to_lla
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF.to_enu" class="md-nav__link">
    <span class="md-ellipsis">
      to_enu
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.make_latin_hypercube" class="md-nav__link">
    <span class="md-ellipsis">
      make_latin_hypercube
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_access/data_access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dispersion_model/gaussian_plume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dispersion Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dlm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DLM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gas_species/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gas Species
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../meteorology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Meteorology
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plotting/plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plotting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pre-Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sensor
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            Sensor
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sensor/sensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sensor/beam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Beam
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sensor/satellite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Satellite
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source_map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Source Map
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../support_functions/spatio_temporal_interpolation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Support Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyelq.coordinate_system" class="md-nav__link">
    <span class="md-ellipsis">
      coordinate_system
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate" class="md-nav__link">
    <span class="md-ellipsis">
      Coordinate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Coordinate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.nof_observations" class="md-nav__link">
    <span class="md-ellipsis">
      nof_observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.from_array" class="md-nav__link">
    <span class="md-ellipsis">
      from_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.to_array" class="md-nav__link">
    <span class="md-ellipsis">
      to_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.to_lla" class="md-nav__link">
    <span class="md-ellipsis">
      to_lla
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.to_ecef" class="md-nav__link">
    <span class="md-ellipsis">
      to_ecef
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.to_enu" class="md-nav__link">
    <span class="md-ellipsis">
      to_enu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.to_object_type" class="md-nav__link">
    <span class="md-ellipsis">
      to_object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.interpolate" class="md-nav__link">
    <span class="md-ellipsis">
      interpolate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.make_grid" class="md-nav__link">
    <span class="md-ellipsis">
      make_grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.Coordinate.create_tree" class="md-nav__link">
    <span class="md-ellipsis">
      create_tree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA" class="md-nav__link">
    <span class="md-ellipsis">
      LLA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LLA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA.nof_observations" class="md-nav__link">
    <span class="md-ellipsis">
      nof_observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA.from_array" class="md-nav__link">
    <span class="md-ellipsis">
      from_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA.to_array" class="md-nav__link">
    <span class="md-ellipsis">
      to_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA.to_lla" class="md-nav__link">
    <span class="md-ellipsis">
      to_lla
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA.to_ecef" class="md-nav__link">
    <span class="md-ellipsis">
      to_ecef
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.LLA.to_enu" class="md-nav__link">
    <span class="md-ellipsis">
      to_enu
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU" class="md-nav__link">
    <span class="md-ellipsis">
      ENU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ENU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU.nof_observations" class="md-nav__link">
    <span class="md-ellipsis">
      nof_observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU.from_array" class="md-nav__link">
    <span class="md-ellipsis">
      from_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU.to_array" class="md-nav__link">
    <span class="md-ellipsis">
      to_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU.to_enu" class="md-nav__link">
    <span class="md-ellipsis">
      to_enu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU.to_lla" class="md-nav__link">
    <span class="md-ellipsis">
      to_lla
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ENU.to_ecef" class="md-nav__link">
    <span class="md-ellipsis">
      to_ecef
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF" class="md-nav__link">
    <span class="md-ellipsis">
      ECEF
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ECEF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF.nof_observations" class="md-nav__link">
    <span class="md-ellipsis">
      nof_observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF.from_array" class="md-nav__link">
    <span class="md-ellipsis">
      from_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF.to_array" class="md-nav__link">
    <span class="md-ellipsis">
      to_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF.to_ecef" class="md-nav__link">
    <span class="md-ellipsis">
      to_ecef
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF.to_lla" class="md-nav__link">
    <span class="md-ellipsis">
      to_lla
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.ECEF.to_enu" class="md-nav__link">
    <span class="md-ellipsis">
      to_enu
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.coordinate_system.make_latin_hypercube" class="md-nav__link">
    <span class="md-ellipsis">
      make_latin_hypercube
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<!--
SPDX-FileCopyrightText: 2024 Shell Global Solutions International B.V. All Rights Reserved.

SPDX-License-Identifier: Apache-2.0
-->

<h1 id="coordinate-system">Coordinate System</h1>


<div class="doc doc-object doc-module">



<a id="pyelq.coordinate_system"></a>
    <div class="doc doc-contents first">

        <p>Coordinate System.</p>
<p>This code provides the definition of, and the functionality for, all the main coordinate systems that are used in
pyELQ. Each coordinate system has relevant methods for features that are commonly required. Also provided is a set of
conversions between each of the systems, alongside some functionality for interpolation.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pyelq.coordinate_system.Coordinate" class="doc doc-heading">
            <code>Coordinate</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Abstract base class for coordinate transformations.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.Coordinate.use_degrees">use_degrees</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag if reference uses degrees (True) or radians (False). Defaults to True.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.Coordinate.ellipsoid">ellipsoid</span></code></td>
            <td>
                  <code><span title="pymap3d.Ellipsoid">Ellipsoid</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Definition of the Ellipsoid used in the coordinate system, for which the default is
WGS84. See: https://en.wikipedia.org/wiki/World_Geodetic_System.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Coordinate</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for coordinate transformations.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        use_degrees (bool): Flag if reference uses degrees (True) or radians (False). Defaults to True.</span>
<span class="sd">        ellipsoid (pm.Ellipsoid): Definition of the Ellipsoid used in the coordinate system, for which the default is</span>
<span class="sd">            WGS84. See: https://en.wikipedia.org/wiki/World_Geodetic_System.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">use_degrees</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ellipsoid</span><span class="p">:</span> <span class="n">pm</span><span class="o">.</span><span class="n">Ellipsoid</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Ellipsoid</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="s2">&quot;wgs84&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nof_observations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of observations contained in the class instance, implemented as dependent property.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Unstack a numpy array into the corresponding coordinates.</span>

<span class="sd">        The method has no return as it sets the corresponding attributes of the coordinate class instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            array (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single</span>
<span class="sd">                array</span>

<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stacks coordinates together into a numpy array.</span>

<span class="sd">        Args:</span>
<span class="sd">            dim (int, optional): Number of dimensions to use, which is either 2 or 3.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single array</span>

<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_lla</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;LLA: Converts coordinates to latitude/longitude/altitude system.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_ecef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ECEF: Convert coordinates to earth centered earth fixed coordinates.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_enu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_latitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts coordinates to East North Up system.</span>

<span class="sd">        If a reference is not provided, the  minimum of coordinates in Lat/Lon/Alt is used as the reference.</span>

<span class="sd">        Args:</span>
<span class="sd">            ref_latitude (float, optional): reference latitude for ENU</span>
<span class="sd">            ref_longitude (float, optional): reference longitude for ENU</span>
<span class="sd">            ref_altitude (float, optional):  reference altitude for ENU</span>

<span class="sd">        Returns:</span>
<span class="sd">           (ENU): East North Up coordinate object</span>

<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_object_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinate_object</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts current object to same class as input coordinate_object.</span>

<span class="sd">        Args:</span>
<span class="sd">            coordinate_object (Coordinate): An coordinate object which provides the coordinate system to convert self to</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Coordinate): The converted coordinate object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">coordinate_object</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordinate_object</span><span class="p">,</span> <span class="n">LLA</span><span class="p">):</span>
                <span class="n">temp_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_lla</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordinate_object</span><span class="p">,</span> <span class="n">ENU</span><span class="p">):</span>
                <span class="n">temp_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_enu</span><span class="p">(</span>
                    <span class="n">ref_latitude</span><span class="o">=</span><span class="n">coordinate_object</span><span class="o">.</span><span class="n">ref_latitude</span><span class="p">,</span>
                    <span class="n">ref_longitude</span><span class="o">=</span><span class="n">coordinate_object</span><span class="o">.</span><span class="n">ref_longitude</span><span class="p">,</span>
                    <span class="n">ref_altitude</span><span class="o">=</span><span class="n">coordinate_object</span><span class="o">.</span><span class="n">ref_altitude</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordinate_object</span><span class="p">,</span> <span class="n">ECEF</span><span class="p">):</span>
                <span class="n">temp_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_ecef</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please provide a valid coordinate type&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">temp_object</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Interpolate data using coordinate object.</span>

<span class="sd">        If locations coordinate system does not match self&#39;s coordinate system it will be converted to same type as</span>
<span class="sd">        self. In the ENU case extra checking needs to take place to check reference locations match up.</span>

<span class="sd">        If only 1 value is provided which needs to be interpolated to many other locations we just set the value at all</span>
<span class="sd">        these locations to the single input value</span>

<span class="sd">        Args:</span>
<span class="sd">            values (np.ndarray): Values to interpolate,  consistent with location in self</span>
<span class="sd">            locations (Coordinate): Coordinate object containing locations to which you want to interpolate</span>
<span class="sd">            dim (int): Number of dimensions to use for interpolation (2 or 3)</span>
<span class="sd">            **kwargs (dict):  Other arguments available in scipy.interpolate.griddata e.g. method, fill_value</span>

<span class="sd">        Returns:</span>
<span class="sd">            Result (np.ndarray): Interpolated values at requested locations.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">locations</span> <span class="o">=</span> <span class="n">locations</span><span class="o">.</span><span class="n">to_object_type</span><span class="p">(</span><span class="n">coordinate_object</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ENU</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ref_latitude</span> <span class="o">!=</span> <span class="n">locations</span><span class="o">.</span><span class="n">ref_latitude</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_longitude</span> <span class="o">!=</span> <span class="n">locations</span><span class="o">.</span><span class="n">ref_longitude</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_altitude</span> <span class="o">!=</span> <span class="n">locations</span><span class="o">.</span><span class="n">ref_altitude</span>
            <span class="p">):</span>
                <span class="n">locations</span> <span class="o">=</span> <span class="n">locations</span><span class="o">.</span><span class="n">to_lla</span><span class="p">()</span>
                <span class="n">locations</span> <span class="o">=</span> <span class="n">locations</span><span class="o">.</span><span class="n">to_enu</span><span class="p">(</span>
                    <span class="n">ref_latitude</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_latitude</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_longitude</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_altitude</span>
                <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">sti</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
            <span class="n">location_in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="n">dim</span><span class="p">),</span>
            <span class="n">values_in</span><span class="o">=</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
            <span class="n">location_out</span><span class="o">=</span><span class="n">locations</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_grid</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">grid_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rectangular&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates grid of values locations based on specified inputs.</span>

<span class="sd">        If the grid type is &#39;spherical&#39;, we scale the latitude and longitude from -90/90 and -180/180 to 0/1 for the</span>
<span class="sd">        use in temp_lat_rad and temp_lon_rad.</span>

<span class="sd">        Args:</span>
<span class="sd">            bounds (np.ndarray): Limits of the grid on which to generate the grid of size [dim x 2]</span>
<span class="sd">                if dim == 2 we assume the third dimension will be zeros</span>
<span class="sd">            grid_type (str, optional): Type of grid to generate, default &#39;rectangular&#39;:</span>
<span class="sd">                     rectangular == rectangular grid of shape grd_shape,</span>
<span class="sd">                     spherical == grid of shape grid_shape taking into account a spherical spacing</span>
<span class="sd">            shape: (tuple, optional): Number of grid cells to generate in each dimension, total number of</span>
<span class="sd">                grid cells will be the product of the entries of this tuple</span>

<span class="sd">        Returns</span>
<span class="sd">            np.ndarray: gridded of locations</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dimension</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">grid_type</span> <span class="o">==</span> <span class="s2">&quot;rectangular&quot;</span><span class="p">:</span>
            <span class="n">dim_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">dim_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">dim_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dim_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">dim_0</span><span class="p">,</span> <span class="n">dim_1</span><span class="p">,</span> <span class="n">dim_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dim_0</span><span class="p">,</span> <span class="n">dim_1</span><span class="p">,</span> <span class="n">dim_2</span><span class="p">)</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">dim_0</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">dim_1</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">dim_2</span><span class="o">.</span><span class="n">flatten</span><span class="p">()],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">grid_type</span> <span class="o">==</span> <span class="s2">&quot;spherical&quot;</span><span class="p">:</span>
            <span class="n">temp_object</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">temp_object</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">array</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
            <span class="n">temp_object</span> <span class="o">=</span> <span class="n">temp_object</span><span class="o">.</span><span class="n">to_lla</span><span class="p">()</span>
            <span class="n">temp_object</span><span class="o">.</span><span class="n">latitude</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_object</span><span class="o">.</span><span class="n">latitude</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">))</span> <span class="o">/</span> <span class="mi">180</span>
            <span class="n">temp_object</span><span class="o">.</span><span class="n">longitude</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_object</span><span class="o">.</span><span class="n">longitude</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">))</span> <span class="o">/</span> <span class="mi">360</span>

            <span class="n">temp_lat_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">temp_object</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop</span><span class="o">=</span><span class="n">temp_object</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">temp_lon_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">temp_object</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop</span><span class="o">=</span><span class="n">temp_object</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">longitude</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">temp_lon_rad</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
            <span class="n">latitude</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">temp_lat_rad</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
            <span class="k">if</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">temp_object</span><span class="o">.</span><span class="n">altitude</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop</span><span class="o">=</span><span class="n">temp_object</span><span class="o">.</span><span class="n">altitude</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">altitude</span><span class="p">)</span>
                <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">latitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="n">longitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="n">altitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">)</span>
                <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">latitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="n">longitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">temp_object</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">array</span><span class="o">=</span><span class="n">array</span><span class="p">)</span>
            <span class="n">temp_object</span> <span class="o">=</span> <span class="n">temp_object</span><span class="o">.</span><span class="n">to_object_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">temp_object</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Please provide a valid grid type&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">array</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KDTree</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create KD tree for the purpose of fast distance computation.</span>

<span class="sd">        Returns:</span>
<span class="sd">                KDTree: Spatial KD tree</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">KDTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_array</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="pyelq.coordinate_system.Coordinate.nof_observations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nof_observations</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of observations contained in the class instance, implemented as dependent property.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.Coordinate.from_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Unstack a numpy array into the corresponding coordinates.</p>
<p>The method has no return as it sets the corresponding attributes of the coordinate class instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single
array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Unstack a numpy array into the corresponding coordinates.</span>

<span class="sd">    The method has no return as it sets the corresponding attributes of the coordinate class instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single</span>
<span class="sd">            array</span>

<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.Coordinate.to_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_array</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Stacks coordinates together into a numpy array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dim</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of dimensions to use, which is either 2 or 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single array</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stacks coordinates together into a numpy array.</span>

<span class="sd">    Args:</span>
<span class="sd">        dim (int, optional): Number of dimensions to use, which is either 2 or 3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single array</span>

<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.Coordinate.to_lla" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_lla</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">to_lla</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;LLA: Converts coordinates to latitude/longitude/altitude system.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.Coordinate.to_ecef" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_ecef</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">to_ecef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ECEF: Convert coordinates to earth centered earth fixed coordinates.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.Coordinate.to_enu" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_enu</span><span class="p">(</span><span class="n">ref_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Converts coordinates to East North Up system.</p>
<p>If a reference is not provided, the  minimum of coordinates in Lat/Lon/Alt is used as the reference.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ref_latitude</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference latitude for ENU</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ref_longitude</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference longitude for ENU</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ref_altitude</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference altitude for ENU</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;ENU&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.coordinate_system.ENU&lt;/code&gt;)" href="#pyelq.coordinate_system.ENU">ENU</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>East North Up coordinate object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">to_enu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_latitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts coordinates to East North Up system.</span>

<span class="sd">    If a reference is not provided, the  minimum of coordinates in Lat/Lon/Alt is used as the reference.</span>

<span class="sd">    Args:</span>
<span class="sd">        ref_latitude (float, optional): reference latitude for ENU</span>
<span class="sd">        ref_longitude (float, optional): reference longitude for ENU</span>
<span class="sd">        ref_altitude (float, optional):  reference altitude for ENU</span>

<span class="sd">    Returns:</span>
<span class="sd">       (ENU): East North Up coordinate object</span>

<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.Coordinate.to_object_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_object_type</span><span class="p">(</span><span class="n">coordinate_object</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Converts current object to same class as input coordinate_object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>coordinate_object</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Coordinate&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.coordinate_system.Coordinate&lt;/code&gt;)" href="#pyelq.coordinate_system.Coordinate">Coordinate</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An coordinate object which provides the coordinate system to convert self to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Coordinate&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.coordinate_system.Coordinate&lt;/code&gt;)" href="#pyelq.coordinate_system.Coordinate">Coordinate</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The converted coordinate object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_object_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinate_object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts current object to same class as input coordinate_object.</span>

<span class="sd">    Args:</span>
<span class="sd">        coordinate_object (Coordinate): An coordinate object which provides the coordinate system to convert self to</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Coordinate): The converted coordinate object</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">coordinate_object</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordinate_object</span><span class="p">,</span> <span class="n">LLA</span><span class="p">):</span>
            <span class="n">temp_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_lla</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordinate_object</span><span class="p">,</span> <span class="n">ENU</span><span class="p">):</span>
            <span class="n">temp_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_enu</span><span class="p">(</span>
                <span class="n">ref_latitude</span><span class="o">=</span><span class="n">coordinate_object</span><span class="o">.</span><span class="n">ref_latitude</span><span class="p">,</span>
                <span class="n">ref_longitude</span><span class="o">=</span><span class="n">coordinate_object</span><span class="o">.</span><span class="n">ref_longitude</span><span class="p">,</span>
                <span class="n">ref_altitude</span><span class="o">=</span><span class="n">coordinate_object</span><span class="o">.</span><span class="n">ref_altitude</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordinate_object</span><span class="p">,</span> <span class="n">ECEF</span><span class="p">):</span>
            <span class="n">temp_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_ecef</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please provide a valid coordinate type&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">temp_object</span>

    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.Coordinate.interpolate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interpolate</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Interpolate data using coordinate object.</p>
<p>If locations coordinate system does not match self's coordinate system it will be converted to same type as
self. In the ENU case extra checking needs to take place to check reference locations match up.</p>
<p>If only 1 value is provided which needs to be interpolated to many other locations we just set the value at all
these locations to the single input value</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values to interpolate,  consistent with location in self</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>locations</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Coordinate&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.coordinate_system.Coordinate&lt;/code&gt;)" href="#pyelq.coordinate_system.Coordinate">Coordinate</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coordinate object containing locations to which you want to interpolate</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dim</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of dimensions to use for interpolation (2 or 3)</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Other arguments available in scipy.interpolate.griddata e.g. method, fill_value</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Result</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Interpolated values at requested locations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Interpolate data using coordinate object.</span>

<span class="sd">    If locations coordinate system does not match self&#39;s coordinate system it will be converted to same type as</span>
<span class="sd">    self. In the ENU case extra checking needs to take place to check reference locations match up.</span>

<span class="sd">    If only 1 value is provided which needs to be interpolated to many other locations we just set the value at all</span>
<span class="sd">    these locations to the single input value</span>

<span class="sd">    Args:</span>
<span class="sd">        values (np.ndarray): Values to interpolate,  consistent with location in self</span>
<span class="sd">        locations (Coordinate): Coordinate object containing locations to which you want to interpolate</span>
<span class="sd">        dim (int): Number of dimensions to use for interpolation (2 or 3)</span>
<span class="sd">        **kwargs (dict):  Other arguments available in scipy.interpolate.griddata e.g. method, fill_value</span>

<span class="sd">    Returns:</span>
<span class="sd">        Result (np.ndarray): Interpolated values at requested locations.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">locations</span> <span class="o">=</span> <span class="n">locations</span><span class="o">.</span><span class="n">to_object_type</span><span class="p">(</span><span class="n">coordinate_object</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ENU</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ref_latitude</span> <span class="o">!=</span> <span class="n">locations</span><span class="o">.</span><span class="n">ref_latitude</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_longitude</span> <span class="o">!=</span> <span class="n">locations</span><span class="o">.</span><span class="n">ref_longitude</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_altitude</span> <span class="o">!=</span> <span class="n">locations</span><span class="o">.</span><span class="n">ref_altitude</span>
        <span class="p">):</span>
            <span class="n">locations</span> <span class="o">=</span> <span class="n">locations</span><span class="o">.</span><span class="n">to_lla</span><span class="p">()</span>
            <span class="n">locations</span> <span class="o">=</span> <span class="n">locations</span><span class="o">.</span><span class="n">to_enu</span><span class="p">(</span>
                <span class="n">ref_latitude</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_latitude</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_longitude</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_altitude</span>
            <span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">sti</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
        <span class="n">location_in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="n">dim</span><span class="p">),</span>
        <span class="n">values_in</span><span class="o">=</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="n">location_out</span><span class="o">=</span><span class="n">locations</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">),</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.Coordinate.make_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_grid</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">grid_type</span><span class="o">=</span><span class="s1">&#39;rectangular&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates grid of values locations based on specified inputs.</p>
<p>If the grid type is 'spherical', we scale the latitude and longitude from -90/90 and -180/180 to 0/1 for the
use in temp_lat_rad and temp_lon_rad.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bounds</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Limits of the grid on which to generate the grid of size [dim x 2]
if dim == 2 we assume the third dimension will be zeros</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>grid_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of grid to generate, default 'rectangular':
     rectangular == rectangular grid of shape grd_shape,
     spherical == grid of shape grid_shape taking into account a spherical spacing</p>
              </div>
            </td>
            <td>
                  <code>&#39;rectangular&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="tuple">tuple</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(tuple, optional): Number of grid cells to generate in each dimension, total number of
grid cells will be the product of the entries of this tuple</p>
              </div>
            </td>
            <td>
                  <code>(5, 5, 1)</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns
    np.ndarray: gridded of locations</p>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_grid</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">grid_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rectangular&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates grid of values locations based on specified inputs.</span>

<span class="sd">    If the grid type is &#39;spherical&#39;, we scale the latitude and longitude from -90/90 and -180/180 to 0/1 for the</span>
<span class="sd">    use in temp_lat_rad and temp_lon_rad.</span>

<span class="sd">    Args:</span>
<span class="sd">        bounds (np.ndarray): Limits of the grid on which to generate the grid of size [dim x 2]</span>
<span class="sd">            if dim == 2 we assume the third dimension will be zeros</span>
<span class="sd">        grid_type (str, optional): Type of grid to generate, default &#39;rectangular&#39;:</span>
<span class="sd">                 rectangular == rectangular grid of shape grd_shape,</span>
<span class="sd">                 spherical == grid of shape grid_shape taking into account a spherical spacing</span>
<span class="sd">        shape: (tuple, optional): Number of grid cells to generate in each dimension, total number of</span>
<span class="sd">            grid cells will be the product of the entries of this tuple</span>

<span class="sd">    Returns</span>
<span class="sd">        np.ndarray: gridded of locations</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dimension</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">grid_type</span> <span class="o">==</span> <span class="s2">&quot;rectangular&quot;</span><span class="p">:</span>
        <span class="n">dim_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">dim_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">dim_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dim_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">dim_0</span><span class="p">,</span> <span class="n">dim_1</span><span class="p">,</span> <span class="n">dim_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dim_0</span><span class="p">,</span> <span class="n">dim_1</span><span class="p">,</span> <span class="n">dim_2</span><span class="p">)</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">dim_0</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">dim_1</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">dim_2</span><span class="o">.</span><span class="n">flatten</span><span class="p">()],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">grid_type</span> <span class="o">==</span> <span class="s2">&quot;spherical&quot;</span><span class="p">:</span>
        <span class="n">temp_object</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">temp_object</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">array</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
        <span class="n">temp_object</span> <span class="o">=</span> <span class="n">temp_object</span><span class="o">.</span><span class="n">to_lla</span><span class="p">()</span>
        <span class="n">temp_object</span><span class="o">.</span><span class="n">latitude</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_object</span><span class="o">.</span><span class="n">latitude</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">))</span> <span class="o">/</span> <span class="mi">180</span>
        <span class="n">temp_object</span><span class="o">.</span><span class="n">longitude</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_object</span><span class="o">.</span><span class="n">longitude</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">))</span> <span class="o">/</span> <span class="mi">360</span>

        <span class="n">temp_lat_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">temp_object</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop</span><span class="o">=</span><span class="n">temp_object</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">temp_lon_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">temp_object</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop</span><span class="o">=</span><span class="n">temp_object</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">longitude</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">temp_lon_rad</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="n">latitude</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">temp_lat_rad</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">if</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">temp_object</span><span class="o">.</span><span class="n">altitude</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop</span><span class="o">=</span><span class="n">temp_object</span><span class="o">.</span><span class="n">altitude</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">altitude</span><span class="p">)</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
                <span class="p">[</span><span class="n">latitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="n">longitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="n">altitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">)</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">latitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="n">longitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">temp_object</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">array</span><span class="o">=</span><span class="n">array</span><span class="p">)</span>
        <span class="n">temp_object</span> <span class="o">=</span> <span class="n">temp_object</span><span class="o">.</span><span class="n">to_object_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">temp_object</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Please provide a valid grid type&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">array</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.Coordinate.create_tree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_tree</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create KD tree for the purpose of fast distance computation.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>KDTree</code></td>            <td>
                  <code><span title="scipy.spatial.KDTree">KDTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spatial KD tree</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KDTree</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create KD tree for the purpose of fast distance computation.</span>

<span class="sd">    Returns:</span>
<span class="sd">            KDTree: Spatial KD tree</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">KDTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_array</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyelq.coordinate_system.LLA" class="doc doc-heading">
            <code>LLA</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Coordinate&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.coordinate_system.Coordinate&lt;/code&gt;)" href="#pyelq.coordinate_system.Coordinate">Coordinate</a></code></p>


        <p>Defines the properties and functionality of the latitude/ longitude/ altitude coordinate system.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.LLA.latitude">latitude</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Latitude values in degrees.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.LLA.longitude">longitude</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Longitude values in degrees.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.LLA.altitude">altitude</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Altitude values in meters with respect to a spheroid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LLA</span><span class="p">(</span><span class="n">Coordinate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Defines the properties and functionality of the latitude/ longitude/ altitude coordinate system.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        latitude (np.ndarray): Latitude values in degrees.</span>
<span class="sd">        longitude (np.ndarray): Longitude values in degrees.</span>
<span class="sd">        altitude (np.ndarray): Altitude values in meters with respect to a spheroid.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">latitude</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">longitude</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">altitude</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nof_observations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of observations contained in the class instance, implemented as dependent property.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">size</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Unstack a numpy array into the corresponding coordinates.</span>

<span class="sd">        The method has no return as it sets the corresponding attributes of the coordinate class instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            array (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single</span>
<span class="sd">                array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">longitude</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stacks coordinates together into a numpy array.</span>

<span class="sd">        Args:</span>
<span class="sd">            dim (int, optional): Number of dimensions to use, which is either 2 or 3.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_lla</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;LLA: Converts coordinates to latitude/longitude/altitude system.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_ecef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ECEF: Convert coordinates to earth centered earth fixed coordinates.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">ecef_object</span> <span class="o">=</span> <span class="n">ECEF</span><span class="p">()</span>
        <span class="n">ecef_object</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ecef_object</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">ecef_object</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">geodetic2ecef</span><span class="p">(</span>
            <span class="n">lat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">alt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude</span><span class="p">,</span> <span class="n">ell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">ecef_object</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_enu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts coordinates to East North Up system.</span>

<span class="sd">        If a reference is not provided, the  minimum of coordinates in Lat/Lon/Alt is used as the reference.</span>

<span class="sd">        Args:</span>
<span class="sd">            ref_latitude (float, optional): reference latitude for ENU</span>
<span class="sd">            ref_longitude (float, optional): reference longitude for ENU</span>
<span class="sd">            ref_altitude (float, optional):  reference altitude for ENU</span>

<span class="sd">        Returns:</span>
<span class="sd">           (ENU): East North Up coordinate object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ref_altitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ref_altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ref_latitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ref_latitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ref_longitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ref_longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span>

        <span class="n">enu_object</span> <span class="o">=</span> <span class="n">ENU</span><span class="p">(</span><span class="n">ref_latitude</span><span class="o">=</span><span class="n">ref_latitude</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="n">ref_longitude</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="n">ref_altitude</span><span class="p">)</span>

        <span class="n">enu_object</span><span class="o">.</span><span class="n">east</span><span class="p">,</span> <span class="n">enu_object</span><span class="o">.</span><span class="n">north</span><span class="p">,</span> <span class="n">enu_object</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">geodetic2enu</span><span class="p">(</span>
            <span class="n">lat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
            <span class="n">lon</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
            <span class="n">h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude</span><span class="p">,</span>
            <span class="n">lat0</span><span class="o">=</span><span class="n">ref_latitude</span><span class="p">,</span>
            <span class="n">lon0</span><span class="o">=</span><span class="n">ref_longitude</span><span class="p">,</span>
            <span class="n">h0</span><span class="o">=</span><span class="n">ref_altitude</span><span class="p">,</span>
            <span class="n">ell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">,</span>
            <span class="n">deg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">enu_object</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="pyelq.coordinate_system.LLA.nof_observations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nof_observations</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of observations contained in the class instance, implemented as dependent property.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.LLA.from_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Unstack a numpy array into the corresponding coordinates.</p>
<p>The method has no return as it sets the corresponding attributes of the coordinate class instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single
array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Unstack a numpy array into the corresponding coordinates.</span>

<span class="sd">    The method has no return as it sets the corresponding attributes of the coordinate class instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single</span>
<span class="sd">            array</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">longitude</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.LLA.to_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_array</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Stacks coordinates together into a numpy array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dim</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of dimensions to use, which is either 2 or 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single array</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stacks coordinates together into a numpy array.</span>

<span class="sd">    Args:</span>
<span class="sd">        dim (int, optional): Number of dimensions to use, which is either 2 or 3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single array</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.LLA.to_lla" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_lla</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_lla</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;LLA: Converts coordinates to latitude/longitude/altitude system.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.LLA.to_ecef" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_ecef</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_ecef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ECEF: Convert coordinates to earth centered earth fixed coordinates.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">ecef_object</span> <span class="o">=</span> <span class="n">ECEF</span><span class="p">()</span>
    <span class="n">ecef_object</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ecef_object</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">ecef_object</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">geodetic2ecef</span><span class="p">(</span>
        <span class="n">lat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">alt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude</span><span class="p">,</span> <span class="n">ell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">ecef_object</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.LLA.to_enu" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_enu</span><span class="p">(</span><span class="n">ref_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Converts coordinates to East North Up system.</p>
<p>If a reference is not provided, the  minimum of coordinates in Lat/Lon/Alt is used as the reference.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ref_latitude</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference latitude for ENU</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ref_longitude</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference longitude for ENU</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ref_altitude</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference altitude for ENU</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;ENU&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.coordinate_system.ENU&lt;/code&gt;)" href="#pyelq.coordinate_system.ENU">ENU</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>East North Up coordinate object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_enu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts coordinates to East North Up system.</span>

<span class="sd">    If a reference is not provided, the  minimum of coordinates in Lat/Lon/Alt is used as the reference.</span>

<span class="sd">    Args:</span>
<span class="sd">        ref_latitude (float, optional): reference latitude for ENU</span>
<span class="sd">        ref_longitude (float, optional): reference longitude for ENU</span>
<span class="sd">        ref_altitude (float, optional):  reference altitude for ENU</span>

<span class="sd">    Returns:</span>
<span class="sd">       (ENU): East North Up coordinate object</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ref_altitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ref_altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ref_latitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ref_latitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ref_longitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ref_longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span>

    <span class="n">enu_object</span> <span class="o">=</span> <span class="n">ENU</span><span class="p">(</span><span class="n">ref_latitude</span><span class="o">=</span><span class="n">ref_latitude</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="n">ref_longitude</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="n">ref_altitude</span><span class="p">)</span>

    <span class="n">enu_object</span><span class="o">.</span><span class="n">east</span><span class="p">,</span> <span class="n">enu_object</span><span class="o">.</span><span class="n">north</span><span class="p">,</span> <span class="n">enu_object</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">geodetic2enu</span><span class="p">(</span>
        <span class="n">lat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
        <span class="n">lon</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
        <span class="n">h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude</span><span class="p">,</span>
        <span class="n">lat0</span><span class="o">=</span><span class="n">ref_latitude</span><span class="p">,</span>
        <span class="n">lon0</span><span class="o">=</span><span class="n">ref_longitude</span><span class="p">,</span>
        <span class="n">h0</span><span class="o">=</span><span class="n">ref_altitude</span><span class="p">,</span>
        <span class="n">ell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">,</span>
        <span class="n">deg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">enu_object</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyelq.coordinate_system.ENU" class="doc doc-heading">
            <code>ENU</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Coordinate&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.coordinate_system.Coordinate&lt;/code&gt;)" href="#pyelq.coordinate_system.Coordinate">Coordinate</a></code></p>


        <p>Defines the properties and functionality of a local East-North-Up coordinate system.</p>
<p>Positions relative to some reference location in metres.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.ENU.ref_latitude">ref_latitude</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference latitude for current ENU system.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.ENU.ref_longitude">ref_longitude</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference longitude for current ENU system.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.ENU.ref_altitude">ref_altitude</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference altitude for current ENU system.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.ENU.east">east</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>East values.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.ENU.north">north</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>North values.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.ENU.up">up</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(np.ndarray): Up values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ENU</span><span class="p">(</span><span class="n">Coordinate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Defines the properties and functionality of a local East-North-Up coordinate system.</span>

<span class="sd">     Positions relative to some reference location in metres.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        ref_latitude (float): Reference latitude for current ENU system.</span>
<span class="sd">        ref_longitude (float): Reference longitude for current ENU system.</span>
<span class="sd">        ref_altitude (float): Reference altitude for current ENU system.</span>
<span class="sd">        east (np.ndarray): East values.</span>
<span class="sd">        north (np.ndarray): North values.</span>
<span class="sd">        up: (np.ndarray): Up values.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ref_latitude</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">ref_longitude</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">ref_altitude</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">east</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">north</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">up</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nof_observations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of observations contained in the class instance, implemented as dependent property.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">east</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="o">.</span><span class="n">size</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Unstack a numpy array into the corresponding coordinates.</span>

<span class="sd">        The method has no return as it sets the corresponding attributes of the coordinate class instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            array (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single</span>
<span class="sd">                array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">east</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">north</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stacks coordinates together into a numpy array.</span>

<span class="sd">        Args:</span>
<span class="sd">            dim (int, optional): Number of dimensions to use, which is either 2 or 3.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">north</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">north</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_enu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts coordinates to East North Up system.</span>

<span class="sd">        If a reference is not provided, the  minimum of coordinates in Lat/Lon/Alt is used as the reference.</span>

<span class="sd">        Args:</span>
<span class="sd">            ref_latitude (float, optional): reference latitude for ENU</span>
<span class="sd">            ref_longitude (float, optional): reference longitude for ENU</span>
<span class="sd">            ref_altitude (float, optional):  reference altitude for ENU</span>

<span class="sd">        Returns:</span>
<span class="sd">           (ENU): East North Up coordinate object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ref_latitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ref_latitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_latitude</span>

        <span class="k">if</span> <span class="n">ref_longitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ref_longitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_longitude</span>

        <span class="k">if</span> <span class="n">ref_altitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ref_altitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_altitude</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ref_latitude</span> <span class="o">==</span> <span class="n">ref_latitude</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_longitude</span> <span class="o">==</span> <span class="n">ref_longitude</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_altitude</span> <span class="o">==</span> <span class="n">ref_altitude</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="n">ecef_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_ecef</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ecef_temp</span><span class="o">.</span><span class="n">to_enu</span><span class="p">(</span><span class="n">ref_longitude</span><span class="o">=</span><span class="n">ref_longitude</span><span class="p">,</span> <span class="n">ref_latitude</span><span class="o">=</span><span class="n">ref_latitude</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="n">ref_altitude</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_lla</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;LLA: Converts coordinates to latitude/longitude/altitude system.&quot;&quot;&quot;</span>
        <span class="n">lla_object</span> <span class="o">=</span> <span class="n">LLA</span><span class="p">()</span>

        <span class="n">lla_object</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">lla_object</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">lla_object</span><span class="o">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">enu2geodetic</span><span class="p">(</span>
            <span class="n">e</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="p">,</span>
            <span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">north</span><span class="p">,</span>
            <span class="n">u</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">,</span>
            <span class="n">lat0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_latitude</span><span class="p">,</span>
            <span class="n">lon0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_longitude</span><span class="p">,</span>
            <span class="n">h0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_altitude</span><span class="p">,</span>
            <span class="n">ell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">,</span>
            <span class="n">deg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">lla_object</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_ecef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ECEF: Convert coordinates to earth centered earth fixed coordinates.&quot;&quot;&quot;</span>
        <span class="n">ecef_object</span> <span class="o">=</span> <span class="n">ECEF</span><span class="p">()</span>

        <span class="n">ecef_object</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ecef_object</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">ecef_object</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">enu2ecef</span><span class="p">(</span>
            <span class="n">e1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="p">,</span>
            <span class="n">n1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">north</span><span class="p">,</span>
            <span class="n">u1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">,</span>
            <span class="n">lat0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_latitude</span><span class="p">,</span>
            <span class="n">lon0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_longitude</span><span class="p">,</span>
            <span class="n">h0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_altitude</span><span class="p">,</span>
            <span class="n">ell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">,</span>
            <span class="n">deg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">ecef_object</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="pyelq.coordinate_system.ENU.nof_observations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nof_observations</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of observations contained in the class instance, implemented as dependent property.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.ENU.from_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Unstack a numpy array into the corresponding coordinates.</p>
<p>The method has no return as it sets the corresponding attributes of the coordinate class instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single
array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Unstack a numpy array into the corresponding coordinates.</span>

<span class="sd">    The method has no return as it sets the corresponding attributes of the coordinate class instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single</span>
<span class="sd">            array</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">east</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">north</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.ENU.to_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_array</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Stacks coordinates together into a numpy array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dim</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of dimensions to use, which is either 2 or 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single array</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stacks coordinates together into a numpy array.</span>

<span class="sd">    Args:</span>
<span class="sd">        dim (int, optional): Number of dimensions to use, which is either 2 or 3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single array</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">north</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">north</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.ENU.to_enu" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_enu</span><span class="p">(</span><span class="n">ref_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Converts coordinates to East North Up system.</p>
<p>If a reference is not provided, the  minimum of coordinates in Lat/Lon/Alt is used as the reference.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ref_latitude</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference latitude for ENU</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ref_longitude</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference longitude for ENU</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ref_altitude</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference altitude for ENU</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;ENU&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.coordinate_system.ENU&lt;/code&gt;)" href="#pyelq.coordinate_system.ENU">ENU</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>East North Up coordinate object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_enu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts coordinates to East North Up system.</span>

<span class="sd">    If a reference is not provided, the  minimum of coordinates in Lat/Lon/Alt is used as the reference.</span>

<span class="sd">    Args:</span>
<span class="sd">        ref_latitude (float, optional): reference latitude for ENU</span>
<span class="sd">        ref_longitude (float, optional): reference longitude for ENU</span>
<span class="sd">        ref_altitude (float, optional):  reference altitude for ENU</span>

<span class="sd">    Returns:</span>
<span class="sd">       (ENU): East North Up coordinate object</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ref_latitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ref_latitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_latitude</span>

    <span class="k">if</span> <span class="n">ref_longitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ref_longitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_longitude</span>

    <span class="k">if</span> <span class="n">ref_altitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ref_altitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_altitude</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ref_latitude</span> <span class="o">==</span> <span class="n">ref_latitude</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_longitude</span> <span class="o">==</span> <span class="n">ref_longitude</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_altitude</span> <span class="o">==</span> <span class="n">ref_altitude</span>
    <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="n">ecef_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_ecef</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">ecef_temp</span><span class="o">.</span><span class="n">to_enu</span><span class="p">(</span><span class="n">ref_longitude</span><span class="o">=</span><span class="n">ref_longitude</span><span class="p">,</span> <span class="n">ref_latitude</span><span class="o">=</span><span class="n">ref_latitude</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="n">ref_altitude</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.ENU.to_lla" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_lla</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_lla</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;LLA: Converts coordinates to latitude/longitude/altitude system.&quot;&quot;&quot;</span>
    <span class="n">lla_object</span> <span class="o">=</span> <span class="n">LLA</span><span class="p">()</span>

    <span class="n">lla_object</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">lla_object</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">lla_object</span><span class="o">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">enu2geodetic</span><span class="p">(</span>
        <span class="n">e</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">north</span><span class="p">,</span>
        <span class="n">u</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">,</span>
        <span class="n">lat0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_latitude</span><span class="p">,</span>
        <span class="n">lon0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_longitude</span><span class="p">,</span>
        <span class="n">h0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_altitude</span><span class="p">,</span>
        <span class="n">ell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">,</span>
        <span class="n">deg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">lla_object</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.ENU.to_ecef" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_ecef</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_ecef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ECEF: Convert coordinates to earth centered earth fixed coordinates.&quot;&quot;&quot;</span>
    <span class="n">ecef_object</span> <span class="o">=</span> <span class="n">ECEF</span><span class="p">()</span>

    <span class="n">ecef_object</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ecef_object</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">ecef_object</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">enu2ecef</span><span class="p">(</span>
        <span class="n">e1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="p">,</span>
        <span class="n">n1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">north</span><span class="p">,</span>
        <span class="n">u1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">,</span>
        <span class="n">lat0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_latitude</span><span class="p">,</span>
        <span class="n">lon0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_longitude</span><span class="p">,</span>
        <span class="n">h0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_altitude</span><span class="p">,</span>
        <span class="n">ell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">,</span>
        <span class="n">deg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">ecef_object</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyelq.coordinate_system.ECEF" class="doc doc-heading">
            <code>ECEF</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Coordinate&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.coordinate_system.Coordinate&lt;/code&gt;)" href="#pyelq.coordinate_system.Coordinate">Coordinate</a></code></p>


        <p>Defines the properties and functionality of an Earth-Centered, Earth-Fixed coordinate system.</p>
<p>See: https://en.wikipedia.org/wiki/Earth-centered,_Earth-fixed_coordinate_system</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.ECEF.x">x</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Eastings values [metres]</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.ECEF.y">y</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Northings values [metres]</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.coordinate_system.ECEF.z">z</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Altitude values [metres]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ECEF</span><span class="p">(</span><span class="n">Coordinate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Defines the properties and functionality of an Earth-Centered, Earth-Fixed coordinate system.</span>

<span class="sd">    See: https://en.wikipedia.org/wiki/Earth-centered,_Earth-fixed_coordinate_system</span>

<span class="sd">    Attributes:</span>
<span class="sd">        x (np.ndarray): Eastings values [metres]</span>
<span class="sd">        y (np.ndarray): Northings values [metres]</span>
<span class="sd">        z (np.ndarray): Altitude values [metres]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nof_observations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of observations contained in the class instance, implemented as dependent property.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">size</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Unstack a numpy array into the corresponding coordinates.</span>

<span class="sd">        The method has no return as it sets the corresponding attributes of the coordinate class instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            array (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single</span>
<span class="sd">                array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stacks coordinates together into a numpy array.</span>

<span class="sd">        Args:</span>
<span class="sd">            dim (int, optional): Number of dimensions to use, which is either 2 or 3.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_ecef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ECEF: Convert coordinates to earth centered earth fixed coordinates.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_lla</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;LLA: Converts coordinates to latitude/longitude/altitude system.&quot;&quot;&quot;</span>
        <span class="n">lla_object</span> <span class="o">=</span> <span class="n">LLA</span><span class="p">()</span>

        <span class="n">lla_object</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">lla_object</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">lla_object</span><span class="o">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">ecef2geodetic</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">ell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">lla_object</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_enu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts coordinates to East North Up system.</span>

<span class="sd">        If a reference is not provided, the  minimum of coordinates in Lat/Lon/Alt is used as the reference.</span>

<span class="sd">        Args:</span>
<span class="sd">            ref_latitude (float, optional): reference latitude for ENU</span>
<span class="sd">            ref_longitude (float, optional): reference longitude for ENU</span>
<span class="sd">            ref_altitude (float, optional):  reference altitude for ENU</span>

<span class="sd">        Returns:</span>
<span class="sd">           (ENU): East North Up coordinate object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ref_latitude</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ref_longitude</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ref_altitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lla_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_lla</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">lla_object</span><span class="o">.</span><span class="n">to_enu</span><span class="p">()</span>

        <span class="n">enu_object</span> <span class="o">=</span> <span class="n">ENU</span><span class="p">(</span><span class="n">ref_latitude</span><span class="o">=</span><span class="n">ref_latitude</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="n">ref_longitude</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="n">ref_altitude</span><span class="p">)</span>

        <span class="n">enu_object</span><span class="o">.</span><span class="n">east</span><span class="p">,</span> <span class="n">enu_object</span><span class="o">.</span><span class="n">north</span><span class="p">,</span> <span class="n">enu_object</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">ecef2enu</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
            <span class="n">z</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
            <span class="n">lat0</span><span class="o">=</span><span class="n">ref_latitude</span><span class="p">,</span>
            <span class="n">lon0</span><span class="o">=</span><span class="n">ref_longitude</span><span class="p">,</span>
            <span class="n">h0</span><span class="o">=</span><span class="n">ref_altitude</span><span class="p">,</span>
            <span class="n">ell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">,</span>
            <span class="n">deg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">enu_object</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="pyelq.coordinate_system.ECEF.nof_observations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nof_observations</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of observations contained in the class instance, implemented as dependent property.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.ECEF.from_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Unstack a numpy array into the corresponding coordinates.</p>
<p>The method has no return as it sets the corresponding attributes of the coordinate class instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single
array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Unstack a numpy array into the corresponding coordinates.</span>

<span class="sd">    The method has no return as it sets the corresponding attributes of the coordinate class instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single</span>
<span class="sd">            array</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.ECEF.to_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_array</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Stacks coordinates together into a numpy array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dim</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of dimensions to use, which is either 2 or 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single array</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stacks coordinates together into a numpy array.</span>

<span class="sd">    Args:</span>
<span class="sd">        dim (int, optional): Number of dimensions to use, which is either 2 or 3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.ndarray): Numpy array of size [n x dim] with n&gt;0 containing the coordinates stacked into a single array</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.ECEF.to_ecef" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_ecef</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_ecef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ECEF: Convert coordinates to earth centered earth fixed coordinates.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.ECEF.to_lla" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_lla</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_lla</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;LLA: Converts coordinates to latitude/longitude/altitude system.&quot;&quot;&quot;</span>
    <span class="n">lla_object</span> <span class="o">=</span> <span class="n">LLA</span><span class="p">()</span>

    <span class="n">lla_object</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">lla_object</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">lla_object</span><span class="o">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">ecef2geodetic</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">ell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">lla_object</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.coordinate_system.ECEF.to_enu" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_enu</span><span class="p">(</span><span class="n">ref_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Converts coordinates to East North Up system.</p>
<p>If a reference is not provided, the  minimum of coordinates in Lat/Lon/Alt is used as the reference.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ref_latitude</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference latitude for ENU</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ref_longitude</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference longitude for ENU</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ref_altitude</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference altitude for ENU</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;ENU&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.coordinate_system.ENU&lt;/code&gt;)" href="#pyelq.coordinate_system.ENU">ENU</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>East North Up coordinate object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_enu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts coordinates to East North Up system.</span>

<span class="sd">    If a reference is not provided, the  minimum of coordinates in Lat/Lon/Alt is used as the reference.</span>

<span class="sd">    Args:</span>
<span class="sd">        ref_latitude (float, optional): reference latitude for ENU</span>
<span class="sd">        ref_longitude (float, optional): reference longitude for ENU</span>
<span class="sd">        ref_altitude (float, optional):  reference altitude for ENU</span>

<span class="sd">    Returns:</span>
<span class="sd">       (ENU): East North Up coordinate object</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ref_latitude</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ref_longitude</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ref_altitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lla_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_lla</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">lla_object</span><span class="o">.</span><span class="n">to_enu</span><span class="p">()</span>

    <span class="n">enu_object</span> <span class="o">=</span> <span class="n">ENU</span><span class="p">(</span><span class="n">ref_latitude</span><span class="o">=</span><span class="n">ref_latitude</span><span class="p">,</span> <span class="n">ref_longitude</span><span class="o">=</span><span class="n">ref_longitude</span><span class="p">,</span> <span class="n">ref_altitude</span><span class="o">=</span><span class="n">ref_altitude</span><span class="p">)</span>

    <span class="n">enu_object</span><span class="o">.</span><span class="n">east</span><span class="p">,</span> <span class="n">enu_object</span><span class="o">.</span><span class="n">north</span><span class="p">,</span> <span class="n">enu_object</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">ecef2enu</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
        <span class="n">z</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
        <span class="n">lat0</span><span class="o">=</span><span class="n">ref_latitude</span><span class="p">,</span>
        <span class="n">lon0</span><span class="o">=</span><span class="n">ref_longitude</span><span class="p">,</span>
        <span class="n">h0</span><span class="o">=</span><span class="n">ref_altitude</span><span class="p">,</span>
        <span class="n">ell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">,</span>
        <span class="n">deg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_degrees</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">enu_object</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="pyelq.coordinate_system.make_latin_hypercube" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_latin_hypercube</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">nof_samples</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Latin Hypercube samples.</p>
<p>Draw samples according to a Latin Hypercube design within the specified bounds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bounds</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Limits of the resulting hypercube of size [dim x 2]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nof_samples</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to draw</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>array</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Samples forming the Latin Hypercube</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/pyelq/coordinate_system.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_latin_hypercube</span><span class="p">(</span><span class="n">bounds</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">nof_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Latin Hypercube samples.</span>

<span class="sd">    Draw samples according to a Latin Hypercube design within the specified bounds.</span>

<span class="sd">    Args:</span>
<span class="sd">        bounds (np.ndarray): Limits of the resulting hypercube of size [dim x 2]</span>
<span class="sd">        nof_samples (int): Number of samples to draw</span>

<span class="sd">    Returns:</span>
<span class="sd">        array (np.ndarray): Samples forming the Latin Hypercube</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dimension</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sampler</span> <span class="o">=</span> <span class="n">qmc</span><span class="o">.</span><span class="n">LatinHypercube</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">dimension</span><span class="p">)</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">nof_samples</span><span class="p">)</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">qmc</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">array</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.instant", "navigation.tabs", "navigation.top", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": {"Pipelines": "pipelines"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>