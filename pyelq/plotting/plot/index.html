
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This repository contains the Python Emission Localization and Quantification software we call pyELQ. It is code used for gas dispersion modelling, in particular methane emissions detection, localization and quantification.">
      
      
        <meta name="author" content="pyELQ">
      
      
      
        <link rel="prev" href="../../model/">
      
      
        <link rel="next" href="../../preprocessing/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Plotting - pyELQ Python Emission Localization and Quantification</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


  
  
    
      
      
        
      
      
    
  
  
  <style>:root{.md-tag.md-tag--pipelines{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M160%20169.3c28.3-12.3%2048-40.5%2048-73.3%200-44.2-35.8-80-80-80S48%2051.8%2048%2096c0%2032.8%2019.7%2061%2048%2073.3V224H32c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h224v54.7c-28.3%2012.3-48%2040.5-48%2073.3%200%2044.2%2035.8%2080%2080%2080s80-35.8%2080-80c0-32.8-19.7-61-48-73.3V288h224c17.7%200%2032-14.3%2032-32s-14.3-32-32-32h-64v-54.7c28.3-12.3%2048-40.5%2048-73.3%200-44.2-35.8-80-80-80s-80%2035.8-80%2080c0%2032.8%2019.7%2061%2048%2073.3V224H160z%22/%3E%3C/svg%3E');}}</style>

    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#plot" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="pyELQ Python Emission Localization and Quantification" class="md-header__button md-logo" aria-label="pyELQ Python Emission Localization and Quantification" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyELQ Python Emission Localization and Quantification
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Plotting
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/sede-open/pyELQ" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    pyELQ
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../component/component/" class="md-tabs__link">
          
  
  
    
  
  pyELQ User Guide

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="pyELQ Python Emission Localization and Quantification" class="md-nav__button md-logo" aria-label="pyELQ Python Emission Localization and Quantification" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    pyELQ Python Emission Localization and Quantification
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sede-open/pyELQ" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    pyELQ
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    pyELQ User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    pyELQ User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Components
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Components
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../component/component/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../component/background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Background
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../component/error_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Error Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../component/offset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Offset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../component/source_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Source Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../coordinate_system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coordinate System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_access/data_access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Access
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Dispersion Model
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Dispersion Model
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dispersion_model/dispersion_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dispersion_model/finite_volume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Finite Volume
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dispersion_model/gaussian_plume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gaussian Plume
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dispersion_model/site_layout/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Site Layout
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dlm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DLM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gas_species/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gas Species
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Meteorology
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Meteorology
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../meteorology/meteorology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../meteorology/meteorology_windfield/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windfield
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Plotting
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Plotting
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        Plot
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __post_init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.show_all" class="md-nav__link">
    <span class="md-ellipsis">
      
        show_all
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_single_trace" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_single_trace
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_trace_per_sensor" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_trace_per_sensor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_fitted_values_per_sensor" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_fitted_values_per_sensor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_emission_rate_estimates" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_emission_rate_estimates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.create_empty_map_figure" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_empty_map_figure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_values_on_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_values_on_map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_quantification_results_on_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_quantification_results_on_map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_coverage" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_coverage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.create_summary_trace" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_summary_trace
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.lighter_rgb" class="md-nav__link">
    <span class="md-ellipsis">
      
        lighter_rgb
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.plot_quantiles_from_array" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_quantiles_from_array
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.create_trace_specifics" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_trace_specifics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.create_plot_specifics" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_plot_specifics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.plot_single_scatter" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_single_scatter
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.plot_single_box" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_single_box
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.plot_polygons_on_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_polygons_on_map
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.plot_regular_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_regular_grid
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.plot_hexagonal_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_hexagonal_grid
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pre-Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Sensor
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Sensor
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sensor/sensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sensor/beam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Beam
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sensor/satellite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Satellite
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Source Map
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_13" >
        
          
          <label class="md-nav__link" for="__nav_2_13" id="__nav_2_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Support Functions
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    Support Functions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../support_functions/spatio_temporal_interpolation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Spatio Temporal Interpolation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../support_functions/post_processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Post Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        Plot
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __post_init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.show_all" class="md-nav__link">
    <span class="md-ellipsis">
      
        show_all
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_single_trace" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_single_trace
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_trace_per_sensor" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_trace_per_sensor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_fitted_values_per_sensor" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_fitted_values_per_sensor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_emission_rate_estimates" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_emission_rate_estimates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.create_empty_map_figure" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_empty_map_figure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_values_on_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_values_on_map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_quantification_results_on_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_quantification_results_on_map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.plot_coverage" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_coverage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.Plot.create_summary_trace" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_summary_trace
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.lighter_rgb" class="md-nav__link">
    <span class="md-ellipsis">
      
        lighter_rgb
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.plot_quantiles_from_array" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_quantiles_from_array
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.create_trace_specifics" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_trace_specifics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.create_plot_specifics" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_plot_specifics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.plot_single_scatter" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_single_scatter
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.plot_single_box" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_single_box
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.plot_polygons_on_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_polygons_on_map
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.plot_regular_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_regular_grid
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyelq.plotting.plot.plot_hexagonal_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_hexagonal_grid
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<!--
SPDX-FileCopyrightText: 2024 Shell Global Solutions International B.V. All Rights Reserved.

SPDX-License-Identifier: Apache-2.0
-->

<h1 id="plot">Plot</h1>


<div class="doc doc-object doc-module">



<a id="pyelq.plotting.plot"></a>
    <div class="doc doc-contents first">

        <p>Plot module.</p>
<p>Large module containing all the plotting code used to create various plots. Contains helper functions and the Plot class
definition.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="pyelq.plotting.plot.Plot" class="doc doc-heading">
            <code>Plot</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">



        <p>Defines the plot class.</p>
<p>Can be used to generate various figures from model components while storing general settings to get consistent
figure appearance.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.plotting.plot.Plot.figure_dict">figure_dict</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure dictionary, used as storage using keys to identify the different figures.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyelq.plotting.plot.Plot.layout">layout</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Layout template for plotly figures, used in all figures generated using this class
instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Plot</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Defines the plot class.</span>

<span class="sd">    Can be used to generate various figures from model components while storing general settings to get consistent</span>
<span class="sd">    figure appearance.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        figure_dict (dict): Figure dictionary, used as storage using keys to identify the different figures.</span>
<span class="sd">        layout (dict, optional): Layout template for plotly figures, used in all figures generated using this class</span>
<span class="sd">            instance.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">figure_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">layout</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Using post init to set the default layout, not able to do this in attribute definition/initialization.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
                <span class="n">font</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;family&quot;</span><span class="p">:</span> <span class="s2">&quot;Futura&quot;</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
                <span class="n">title</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>
                <span class="n">title_font</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">},</span>
                <span class="n">xaxis</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="s2">&quot;outside&quot;</span><span class="p">,</span> <span class="s2">&quot;showline&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
                <span class="n">yaxis</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="s2">&quot;outside&quot;</span><span class="p">,</span> <span class="s2">&quot;showline&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
                <span class="n">legend</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;yanchor&quot;</span><span class="p">:</span> <span class="s2">&quot;middle&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                    <span class="s2">&quot;xanchor&quot;</span><span class="p">:</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span>
                    <span class="s2">&quot;font&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">},</span>
                <span class="p">},</span>
            <span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">show_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="s2">&quot;browser&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show all the figures which are in the figure dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            renderer (str, optional): Default renderer to use when showing the figures.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">fig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">renderer</span><span class="o">=</span><span class="n">renderer</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_single_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_to_plot</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">SlabAndSpike</span><span class="p">],</span> <span class="n">SourceModel</span><span class="p">,</span> <span class="n">MCMC</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plotting a trace of a single variable.</span>

<span class="sd">        Depending on the object to plot it creates a figure which is stored in the figure_dict attribute.</span>
<span class="sd">        First it grabs all the specifics needed for the plot and then plots the trace.</span>

<span class="sd">        Args:</span>
<span class="sd">            object_to_plot (Union[Type[SlabAndSpike], SourceModel, MCMC]): The object from which to plot a variable</span>
<span class="sd">            **kwargs (Any): Additional key word arguments, e.g. burn_in, legend_group, show_legend, dict_key, used in</span>
<span class="sd">                some specific plots but not applicable to all.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plot_specifics</span> <span class="o">=</span> <span class="n">create_trace_specifics</span><span class="p">(</span><span class="n">object_to_plot</span><span class="o">=</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">burn_in</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;burn_in&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_single_scatter</span><span class="p">(</span>
            <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
            <span class="n">x_values</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;x_values&quot;</span><span class="p">],</span>
            <span class="n">y_values</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;y_values&quot;</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
            <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">burn_in</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Burn in: </span><span class="si">{</span><span class="n">burn_in</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">SlabAndSpike</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">SourceModel</span><span class="p">):</span>
            <span class="n">prior_num_sources_on</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">object_to_plot</span><span class="o">.</span><span class="n">emission_rate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">object_to_plot</span><span class="o">.</span><span class="n">slab_probability</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span>
                <span class="n">y</span><span class="o">=</span><span class="n">prior_num_sources_on</span><span class="p">,</span>
                <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span>
                <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Prior sources &#39;on&#39;: </span><span class="si">{</span><span class="n">prior_num_sources_on</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;title_text&quot;</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;x_label&quot;</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;y_label&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;dict_key&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">fig</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_trace_per_sensor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">object_to_plot</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ErrorModel</span><span class="p">,</span> <span class="n">PerSensor</span><span class="p">,</span> <span class="n">MCMC</span><span class="p">],</span>
        <span class="n">sensor_object</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SensorGroup</span><span class="p">,</span> <span class="n">Sensor</span><span class="p">],</span>
        <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plotting a trace of a single variable per sensor.</span>

<span class="sd">        Depending on the object to plot it creates a figure which is stored in the figure_dict attribute.</span>
<span class="sd">        First it grabs all the specifics needed for the plot and then plots the trace per sensor.</span>

<span class="sd">        Args:</span>
<span class="sd">            object_to_plot (Union[ErrorModel, PerSensor, MCMC]): The object which to plot a variable from</span>
<span class="sd">            sensor_object (Union[SensorGroup, Sensor]): Sensor object associated with the object_to_plot</span>
<span class="sd">            plot_type (str): String specifying a line or box plot.</span>
<span class="sd">            **kwargs (Any): Additional key word arguments, e.g. burn_in, legend_group, show_legend, dict_key, used in</span>
<span class="sd">                some specific plots but not applicable to all.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sensor_object</span><span class="p">,</span> <span class="n">Sensor</span><span class="p">):</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">SensorGroup</span><span class="p">()</span>
            <span class="n">temp</span><span class="o">.</span><span class="n">add_sensor</span><span class="p">(</span><span class="n">sensor_object</span><span class="p">)</span>
            <span class="n">sensor_object</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        <span class="n">plot_specifics</span> <span class="o">=</span> <span class="n">create_plot_specifics</span><span class="p">(</span>
            <span class="n">object_to_plot</span><span class="o">=</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">sensor_object</span><span class="o">=</span><span class="n">sensor_object</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="n">burn_in</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;burn_in&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">sensor_idx</span><span class="p">,</span> <span class="n">sensor_key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">color_idx</span> <span class="o">=</span> <span class="n">sensor_idx</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">color_map</span><span class="p">)</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">sensor_object</span><span class="o">.</span><span class="n">color_map</span><span class="p">[</span><span class="n">color_idx</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;plot_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_single_scatter</span><span class="p">(</span>
                    <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                    <span class="n">x_values</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;x_values&quot;</span><span class="p">],</span>
                    <span class="n">y_values</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;y_values&quot;</span><span class="p">][</span><span class="n">sensor_idx</span><span class="p">,</span> <span class="p">:],</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">sensor_key</span><span class="p">,</span>
                    <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;plot_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;box&quot;</span><span class="p">:</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_single_box</span><span class="p">(</span>
                    <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                    <span class="n">y_values</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;y_values&quot;</span><span class="p">][</span><span class="n">sensor_idx</span><span class="p">,</span> <span class="n">burn_in</span><span class="p">:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">sensor_key</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">burn_in</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;plot_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Burn in: </span><span class="si">{</span><span class="n">burn_in</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;title_text&quot;</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;x_label&quot;</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;y_label&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;dict_key&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">fig</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_fitted_values_per_sensor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mcmc_object</span><span class="p">:</span> <span class="n">MCMC</span><span class="p">,</span>
        <span class="n">sensor_object</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SensorGroup</span><span class="p">,</span> <span class="n">Sensor</span><span class="p">],</span>
        <span class="n">background_model</span><span class="p">:</span> <span class="n">TemporalBackground</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">burn_in</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the fitted values from the mcmc object against time, also shows the estimated background when inputted.</span>

<span class="sd">        Based on the inputs it plots the results of the mcmc analysis, being the fitted values of the concentration</span>
<span class="sd">        measurements together with the 10th and 90th quantile lines to show the goodness of fit of the estimates.</span>

<span class="sd">        The created figure is stored in the figure_dict attribute.</span>

<span class="sd">        Args:</span>
<span class="sd">            mcmc_object (MCMC): MCMC object which contains the fitted values in the store attribute of the object.</span>
<span class="sd">            sensor_object (Union[SensorGroup, Sensor]): Sensor object associated with the object_to_plot</span>
<span class="sd">            background_model (TemporalBackground, optional): Background model containing the estimated background.</span>
<span class="sd">            burn_in (int, optional): Number of burn-in iterations to discard before calculating the quantiles</span>
<span class="sd">                and median. Defaults to 0.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mcmc_object</span><span class="o">.</span><span class="n">store</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing fitted values (&#39;y&#39;) in mcmc_store_object&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sensor_object</span><span class="p">,</span> <span class="n">Sensor</span><span class="p">):</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">SensorGroup</span><span class="p">()</span>
            <span class="n">temp</span><span class="o">.</span><span class="n">add_sensor</span><span class="p">(</span><span class="n">sensor_object</span><span class="p">)</span>
            <span class="n">sensor_object</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

        <span class="n">y_values_overall</span> <span class="o">=</span> <span class="n">mcmc_object</span><span class="o">.</span><span class="n">store</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
        <span class="n">dict_key</span> <span class="o">=</span> <span class="s2">&quot;fitted_values&quot;</span>
        <span class="n">title_text</span> <span class="o">=</span> <span class="s2">&quot;Observations and Predicted Model Values Against Time&quot;</span>
        <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Time&quot;</span>
        <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Concentration (ppm)&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">sensor_idx</span><span class="p">,</span> <span class="n">sensor_key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">plot_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">sensor_index</span> <span class="o">==</span> <span class="n">sensor_idx</span><span class="p">)</span>

            <span class="n">x_values</span> <span class="o">=</span> <span class="n">sensor_object</span><span class="p">[</span><span class="n">sensor_key</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
            <span class="n">y_values</span> <span class="o">=</span> <span class="n">y_values_overall</span><span class="p">[</span><span class="n">plot_idx</span><span class="p">,</span> <span class="n">burn_in</span><span class="p">:]</span>

            <span class="n">color_idx</span> <span class="o">=</span> <span class="n">sensor_idx</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">color_map</span><span class="p">)</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">sensor_object</span><span class="o">.</span><span class="n">color_map</span><span class="p">[</span><span class="n">color_idx</span><span class="p">]</span>

            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_quantiles_from_array</span><span class="p">(</span>
                <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">x_values</span><span class="o">=</span><span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="o">=</span><span class="n">y_values</span><span class="p">,</span> <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">sensor_key</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">background_model</span><span class="p">,</span> <span class="n">TemporalBackground</span><span class="p">):</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_quantiles_from_array</span><span class="p">(</span>
                <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                <span class="n">x_values</span><span class="o">=</span><span class="n">background_model</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                <span class="n">y_values</span><span class="o">=</span><span class="n">background_model</span><span class="o">.</span><span class="n">bg</span><span class="p">,</span>
                <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgb(186, 186, 186)&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Background&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">for_each_trace</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">trace</span><span class="p">:</span> <span class="p">(</span>
                    <span class="n">trace</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Background&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">trace</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Median for Background&quot;</span> <span class="k">else</span> <span class="p">()</span>
                <span class="p">),</span>
            <span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">sensor_object</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">color_map</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
            <span class="n">yref</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
            <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
            <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
            <span class="n">font</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">},</span>
            <span class="n">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="n">showarrow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">borderpad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
            <span class="n">bordercolor</span><span class="o">=</span><span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
            <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;&lt;b&gt;Point&lt;/b&gt;: Real observation&lt;br&gt;&lt;b&gt;Line&lt;/b&gt;: Predicted Value&lt;br&gt;&lt;b&gt;Shading&lt;/b&gt;: &quot;</span> <span class="o">+</span> <span class="s2">&quot;Quantiles 10-90&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title_text</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">x_label</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">y_label</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_emission_rate_estimates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_model_object</span><span class="p">,</span> <span class="n">y_axis_type</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the emission rate estimates source model object against MCMC iteration.</span>

<span class="sd">        Based on the inputs it plots the results of the mcmc analysis, being the estimated emission rate values for</span>
<span class="sd">        each source location together with the total emissions estimate, which is the sum over all source locations.</span>

<span class="sd">        The created figure is stored in the figure_dict attribute.</span>

<span class="sd">        After the loop over all sources we add an empty trace to have the legend entry and desired legend group</span>
<span class="sd">        behaviour.</span>

<span class="sd">        Args:</span>
<span class="sd">            source_model_object (SourceModel): Source model object which contains the estimated emission rate estimates.</span>
<span class="sd">            y_axis_type (str, optional): String to indicate whether the y-axis should be linear of log scale.</span>
<span class="sd">            **kwargs (Any): Additional key word arguments, e.g. burn_in, dict_key, used in some specific plots but not</span>
<span class="sd">                applicable to all.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">total_emissions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">source_model_object</span><span class="o">.</span><span class="n">emission_rate</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">total_emissions</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

        <span class="n">burn_in</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;burn_in&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">dict_key</span> <span class="o">=</span> <span class="s2">&quot;estimated_values_plot&quot;</span>
        <span class="n">title_text</span> <span class="o">=</span> <span class="s2">&quot;Estimated Values of Sources With Respect to MCMC Iterations&quot;</span>
        <span class="n">x_label</span> <span class="o">=</span> <span class="n">MCMC_ITERATION_NUMBER_LITERAL</span>
        <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Estimated Emission&lt;br&gt;Values (kg/hr)&quot;</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_single_scatter</span><span class="p">(</span>
            <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
            <span class="n">x_values</span><span class="o">=</span><span class="n">x_values</span><span class="p">,</span>
            <span class="n">y_values</span><span class="o">=</span><span class="n">total_emissions</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgb(239, 85, 59)&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Total Site Emissions&quot;</span><span class="p">,</span>
            <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
            <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">source_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">source_model_object</span><span class="o">.</span><span class="n">emission_rate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">y_values</span> <span class="o">=</span> <span class="n">source_model_object</span><span class="o">.</span><span class="n">emission_rate</span><span class="p">[</span><span class="n">source_idx</span><span class="p">,</span> <span class="p">:]</span>
            <span class="k">if</span> <span class="n">source_model_object</span><span class="o">.</span><span class="n">individual_source_labels</span><span class="p">[</span><span class="n">source_idx</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">source_label</span> <span class="o">=</span> <span class="n">source_model_object</span><span class="o">.</span><span class="n">individual_source_labels</span><span class="p">[</span><span class="n">source_idx</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">source_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Source </span><span class="si">{</span><span class="n">source_idx</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_single_scatter</span><span class="p">(</span>
                <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                <span class="n">x_values</span><span class="o">=</span><span class="n">x_values</span><span class="p">,</span>
                <span class="n">y_values</span><span class="o">=</span><span class="n">y_values</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">RGB_LIGHT_BLUE</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">source_label</span><span class="p">,</span>
                <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
                <span class="n">show_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">legend_group</span><span class="o">=</span><span class="s2">&quot;Source traces&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_single_scatter</span><span class="p">(</span>
            <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
            <span class="n">x_values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">None</span><span class="p">]),</span>
            <span class="n">y_values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">None</span><span class="p">]),</span>
            <span class="n">color</span><span class="o">=</span><span class="n">RGB_LIGHT_BLUE</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Source traces&quot;</span><span class="p">,</span>
            <span class="n">burn_in</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">burn_in</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Burn in: </span><span class="si">{</span><span class="n">burn_in</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span>
            <span class="n">yref</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
            <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
            <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
            <span class="n">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="n">font</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">},</span>
            <span class="n">showarrow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">borderpad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
            <span class="n">bordercolor</span><span class="o">=</span><span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
            <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;&lt;b&gt;Total Site Emissions&lt;/b&gt; are&lt;br&gt;the sum of all estimated&lt;br&gt;&quot;</span>
                <span class="s2">&quot;emission rates at a given&lt;br&gt;iteration number.&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title_text</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">x_label</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">y_label</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y_axis_type</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
            <span class="n">dict_key</span> <span class="o">=</span> <span class="s2">&quot;log_estimated_values_plot&quot;</span>
        <span class="k">elif</span> <span class="n">y_axis_type</span> <span class="o">!=</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Only linear or log y axis type is allowed, </span><span class="si">{</span><span class="n">y_axis_type</span><span class="si">}</span><span class="s2"> was currently specified.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_empty_map_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;map_plot&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creating an empty map figure to use when you want to add additional traces on a map.</span>

<span class="sd">        Args:</span>
<span class="sd">            dict_key (str, optional): String key for figure dictionary</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Scattermap</span><span class="p">(),</span>
            <span class="n">layout</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;map_style&quot;</span><span class="p">:</span> <span class="s2">&quot;carto-positron&quot;</span><span class="p">,</span>
                <span class="s2">&quot;map_center_lat&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s2">&quot;map_center_lon&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s2">&quot;map_zoom&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_values_on_map</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">dict_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span> <span class="n">LLA</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">aggregate_function</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot values on a map based on coordinates.</span>

<span class="sd">        Args:</span>
<span class="sd">            dict_key (str): Sting key to use in the figure dictionary</span>
<span class="sd">            coordinates (LLA): LLA coordinates to use in plotting the values on the map</span>
<span class="sd">            values (np.ndarray): Numpy array of values consistent with coordinates to plot on the map</span>
<span class="sd">            aggregate_function (Callable, optional): Function which to apply on the data in each hexagonal bin to</span>
<span class="sd">                aggregate the data and visualise the result.</span>
<span class="sd">            **kwargs (Any): Additional keyword arguments for plotting behaviour (opacity, map_color_scale, num_hexagons,</span>
<span class="sd">                show_positions)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">map_color_scale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;map_color_scale&quot;</span><span class="p">,</span> <span class="s2">&quot;YlOrRd&quot;</span><span class="p">)</span>
        <span class="n">num_hexagons</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;num_hexagons&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="n">show_positions</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;show_positions&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="n">latitude_check</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">is_regularly_spaced</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span>
        <span class="n">longitude_check</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">is_regularly_spaced</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">latitude_check</span> <span class="ow">and</span> <span class="n">longitude_check</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_empty_map_figure</span><span class="p">(</span><span class="n">dict_key</span><span class="o">=</span><span class="n">dict_key</span><span class="p">)</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="n">plot_regular_grid</span><span class="p">(</span>
                <span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
                <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
                <span class="n">map_color_scale</span><span class="o">=</span><span class="n">map_color_scale</span><span class="p">,</span>
                <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span>
                <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_hexagonal_grid</span><span class="p">(</span>
                <span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
                <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
                <span class="n">map_color_scale</span><span class="o">=</span><span class="n">map_color_scale</span><span class="p">,</span>
                <span class="n">num_hexagons</span><span class="o">=</span><span class="n">num_hexagons</span><span class="p">,</span>
                <span class="n">show_positions</span><span class="o">=</span><span class="n">show_positions</span><span class="p">,</span>
                <span class="n">aggregate_function</span><span class="o">=</span><span class="n">aggregate_function</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">map_style</span><span class="o">=</span><span class="s2">&quot;carto-positron&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>

        <span class="n">center_longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span>
        <span class="n">center_latitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;zoom&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">center_longitude</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">center_latitude</span><span class="p">}}</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_quantification_results_on_map</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model_object</span><span class="p">:</span> <span class="s2">&quot;ELQModel&quot;</span><span class="p">,</span>
        <span class="n">source_model_to_plot_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">bin_size_x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">bin_size_y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">normalized_count_limit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">,</span>
        <span class="n">burn_in</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">show_summary_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">show_fixed_source_locations</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to create a map with the quantification results of the model object.</span>

<span class="sd">        This function takes the &quot;SourceModel&quot; object and calculates the statistics for the quantification results.</span>
<span class="sd">        It then populates the figure dictionary with three different maps showing the normalized count,</span>
<span class="sd">        median emission rate and the inter-quartile range of the emission rate estimates.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_object (ELQModel): ELQModel object containing the quantification results</span>
<span class="sd">            source_model_to_plot_key (str, optional): Key to use in the model_object.components dictionary to access</span>
<span class="sd">              the SourceModel object. If None, defaults to &quot;sources_combined&quot;.</span>
<span class="sd">            bin_size_x (float, optional): Size of the bins in the x-direction. Defaults to 1.</span>
<span class="sd">            bin_size_y (float, optional): Size of the bins in the y-direction. Defaults to 1.</span>
<span class="sd">            normalized_count_limit (float, optional): Limit for the normalized count to show on the map.</span>
<span class="sd">                Defaults to 0.005.</span>
<span class="sd">            burn_in (int, optional): Number of burn-in iterations to discard before calculating the statistics.</span>
<span class="sd">                Defaults to 0.</span>
<span class="sd">            show_summary_results (bool, optional): Flag to show the summary results on the map. Defaults to True.</span>
<span class="sd">            show_fixed_source_locations (bool, optional): Flag to show the fixed sources location when present in one</span>
<span class="sd">                of the sourcemaps. Defaults to True.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">source_model_to_plot_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">source_model_to_plot_key</span> <span class="o">=</span> <span class="s2">&quot;sources_combined&quot;</span>

        <span class="n">source_model</span> <span class="o">=</span> <span class="n">model_object</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">source_model_to_plot_key</span><span class="p">]</span>
        <span class="n">sensor_object</span> <span class="o">=</span> <span class="n">model_object</span><span class="o">.</span><span class="n">sensor_object</span>

        <span class="n">source_locations</span> <span class="o">=</span> <span class="n">source_model</span><span class="o">.</span><span class="n">all_source_locations</span>
        <span class="n">emission_rates</span> <span class="o">=</span> <span class="n">source_model</span><span class="o">.</span><span class="n">emission_rate</span>

        <span class="n">ref_latitude</span> <span class="o">=</span> <span class="n">source_locations</span><span class="o">.</span><span class="n">ref_latitude</span>
        <span class="n">ref_longitude</span> <span class="o">=</span> <span class="n">source_locations</span><span class="o">.</span><span class="n">ref_longitude</span>
        <span class="n">ref_altitude</span> <span class="o">=</span> <span class="n">source_locations</span><span class="o">.</span><span class="n">ref_altitude</span>

        <span class="n">datetime_min_string</span> <span class="o">=</span> <span class="n">sensor_object</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%b-%Y, %H:%M:%S&quot;</span><span class="p">)</span>
        <span class="n">datetime_max_string</span> <span class="o">=</span> <span class="n">sensor_object</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%b-%Y, %H:%M:%S&quot;</span><span class="p">)</span>

        <span class="n">result_weighted</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">normalized_count</span><span class="p">,</span> <span class="n">count_boolean</span><span class="p">,</span> <span class="n">enu_points</span><span class="p">,</span> <span class="n">summary_result</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">calculate_rectangular_statistics</span><span class="p">(</span>
                <span class="n">emission_rates</span><span class="o">=</span><span class="n">emission_rates</span><span class="p">,</span>
                <span class="n">source_locations</span><span class="o">=</span><span class="n">source_locations</span><span class="p">,</span>
                <span class="n">bin_size_x</span><span class="o">=</span><span class="n">bin_size_x</span><span class="p">,</span>
                <span class="n">bin_size_y</span><span class="o">=</span><span class="n">bin_size_y</span><span class="p">,</span>
                <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
                <span class="n">normalized_count_limit</span><span class="o">=</span><span class="n">normalized_count_limit</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">polygons</span> <span class="o">=</span> <span class="n">create_lla_polygons_from_xy_points</span><span class="p">(</span>
            <span class="n">points_array</span><span class="o">=</span><span class="n">enu_points</span><span class="p">,</span>
            <span class="n">ref_latitude</span><span class="o">=</span><span class="n">ref_latitude</span><span class="p">,</span>
            <span class="n">ref_longitude</span><span class="o">=</span><span class="n">ref_longitude</span><span class="p">,</span>
            <span class="n">ref_altitude</span><span class="o">=</span><span class="n">ref_altitude</span><span class="p">,</span>
            <span class="n">boolean_mask</span><span class="o">=</span><span class="n">count_boolean</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">show_summary_results</span><span class="p">:</span>
            <span class="n">summary_trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_summary_trace</span><span class="p">(</span><span class="n">summary_result</span><span class="o">=</span><span class="n">summary_result</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">create_empty_map_figure</span><span class="p">(</span><span class="n">dict_key</span><span class="o">=</span><span class="s2">&quot;count_map&quot;</span><span class="p">)</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="n">plot_polygons_on_map</span><span class="p">(</span>
            <span class="n">polygons</span><span class="o">=</span><span class="n">polygons</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="n">normalized_count</span><span class="p">[</span><span class="n">count_boolean</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
            <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;normalized_count&quot;</span><span class="p">,</span>
            <span class="n">colorbar</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Normalized Count&quot;</span><span class="p">,</span> <span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;h&quot;</span><span class="p">},</span>
            <span class="n">map_color_scale</span><span class="o">=</span><span class="s2">&quot;Bluered&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">map_style</span><span class="o">=</span><span class="s2">&quot;carto-positron&quot;</span><span class="p">,</span>
            <span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;zoom&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">ref_longitude</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">ref_latitude</span><span class="p">}},</span>
            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Source location probability &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(&gt;=</span><span class="si">{</span><span class="n">normalized_count_limit</span><span class="si">}</span><span class="s2">) for &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datetime_min_string</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">datetime_max_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">font_family</span><span class="o">=</span><span class="s2">&quot;Futura&quot;</span><span class="p">,</span>
            <span class="n">font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">sensor_object</span><span class="o">.</span><span class="n">plot_sensor_location</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">adjusted_result_weights</span> <span class="o">=</span> <span class="n">result_weighted</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">adjusted_result_weights</span><span class="p">[</span><span class="n">adjusted_result_weights</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="n">median_of_all_emissions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">adjusted_result_weights</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">create_empty_map_figure</span><span class="p">(</span><span class="n">dict_key</span><span class="o">=</span><span class="s2">&quot;median_map&quot;</span><span class="p">)</span>

        <span class="n">trace</span> <span class="o">=</span> <span class="n">plot_polygons_on_map</span><span class="p">(</span>
            <span class="n">polygons</span><span class="o">=</span><span class="n">polygons</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="n">median_of_all_emissions</span><span class="p">[</span><span class="n">count_boolean</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
            <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;median_emission&quot;</span><span class="p">,</span>
            <span class="n">colorbar</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Median Emission&quot;</span><span class="p">,</span> <span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;h&quot;</span><span class="p">},</span>
            <span class="n">map_color_scale</span><span class="o">=</span><span class="s2">&quot;Bluered&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">map_style</span><span class="o">=</span><span class="s2">&quot;carto-positron&quot;</span><span class="p">,</span>
            <span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;zoom&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">ref_longitude</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">ref_latitude</span><span class="p">}},</span>
            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Median emission rate estimate for </span><span class="si">{</span><span class="n">datetime_min_string</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">datetime_max_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">font_family</span><span class="o">=</span><span class="s2">&quot;Futura&quot;</span><span class="p">,</span>
            <span class="n">font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">sensor_object</span><span class="o">.</span><span class="n">plot_sensor_location</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">iqr_of_all_emissions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanquantile</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">adjusted_result_weights</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanquantile</span><span class="p">(</span>
            <span class="n">a</span><span class="o">=</span><span class="n">adjusted_result_weights</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_empty_map_figure</span><span class="p">(</span><span class="n">dict_key</span><span class="o">=</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">)</span>

        <span class="n">trace</span> <span class="o">=</span> <span class="n">plot_polygons_on_map</span><span class="p">(</span>
            <span class="n">polygons</span><span class="o">=</span><span class="n">polygons</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="n">iqr_of_all_emissions</span><span class="p">[</span><span class="n">count_boolean</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
            <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;iqr_emission&quot;</span><span class="p">,</span>
            <span class="n">colorbar</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;IQR&quot;</span><span class="p">,</span> <span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;h&quot;</span><span class="p">},</span>
            <span class="n">map_color_scale</span><span class="o">=</span><span class="s2">&quot;Bluered&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">map_style</span><span class="o">=</span><span class="s2">&quot;carto-positron&quot;</span><span class="p">,</span>
            <span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;zoom&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">ref_longitude</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">ref_latitude</span><span class="p">}},</span>
            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inter Quartile range (25%-75%) of emission rate &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;estimate for </span><span class="si">{</span><span class="n">datetime_min_string</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">datetime_max_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">font_family</span><span class="o">=</span><span class="s2">&quot;Futura&quot;</span><span class="p">,</span>
            <span class="n">font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">sensor_object</span><span class="o">.</span><span class="n">plot_sensor_location</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_fixed_source_locations</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">model_object</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;fixed&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)):</span>
                    <span class="n">source_model_fixed</span> <span class="o">=</span> <span class="n">model_object</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                    <span class="n">source_locations_fixed</span> <span class="o">=</span> <span class="n">source_model_fixed</span><span class="o">.</span><span class="n">all_source_locations</span>
                    <span class="n">source_location_fixed_lla</span> <span class="o">=</span> <span class="n">source_locations_fixed</span><span class="o">.</span><span class="n">to_lla</span><span class="p">()</span>
                    <span class="n">sources_lat</span> <span class="o">=</span> <span class="n">source_location_fixed_lla</span><span class="o">.</span><span class="n">latitude</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="n">sources_lon</span> <span class="o">=</span> <span class="n">source_location_fixed_lla</span><span class="o">.</span><span class="n">longitude</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="n">fixed_source_location_trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scattermap</span><span class="p">(</span>
                        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                        <span class="n">lon</span><span class="o">=</span><span class="n">sources_lon</span><span class="p">,</span>
                        <span class="n">lat</span><span class="o">=</span><span class="n">sources_lat</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Fixed source locations, </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">marker</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">fixed_source_location_trace</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">fixed_source_location_trace</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">fixed_source_location_trace</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_summary_results</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">summary_trace</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">summary_trace</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">summary_trace</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_coverage</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">coordinates</span><span class="p">:</span> <span class="n">LLA</span><span class="p">,</span>
        <span class="n">couplings</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">threshold_function</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span>
        <span class="n">coverage_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
        <span class="n">opacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
        <span class="n">map_color_scale</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a coverage plot using the coverage function from Gaussian Plume.</span>

<span class="sd">        Args:</span>
<span class="sd">            coordinates (LLA object): A LLA coordinate object containing a set of locations.</span>
<span class="sd">            couplings (np.array): The calculated values of coupling (The &#39;A matrix&#39;) for a set of wind data.</span>
<span class="sd">            threshold_function (Callable, optional): Callable function which returns some single value that defines the</span>
<span class="sd">                                         maximum or &#39;threshold&#39; coupling. Examples: np.quantile(q=0.9),</span>
<span class="sd">                                         np.max, np.mean. Defaults to np.max.</span>
<span class="sd">            coverage_threshold (float, optional): The threshold value of the estimated emission rate which is</span>
<span class="sd">                                                  considered to be within the coverage. Defaults to 6 kg/hr.</span>
<span class="sd">            opacity (float): The opacity of the grid cells when they are plotted.</span>
<span class="sd">            map_color_scale (str): The string which defines which plotly colour scale should be used when plotting</span>
<span class="sd">                                   the values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coverage_values</span> <span class="o">=</span> <span class="n">GaussianPlume</span><span class="p">(</span><span class="n">source_map</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">compute_coverage</span><span class="p">(</span>
            <span class="n">couplings</span><span class="o">=</span><span class="n">couplings</span><span class="p">,</span> <span class="n">threshold_function</span><span class="o">=</span><span class="n">threshold_function</span><span class="p">,</span> <span class="n">coverage_threshold</span><span class="o">=</span><span class="n">coverage_threshold</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_values_on_map</span><span class="p">(</span>
            <span class="n">dict_key</span><span class="o">=</span><span class="s2">&quot;coverage_map&quot;</span><span class="p">,</span>
            <span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="n">coverage_values</span><span class="p">,</span>
            <span class="n">aggregate_function</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span>
            <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
            <span class="n">map_color_scale</span><span class="o">=</span><span class="n">map_color_scale</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_summary_trace</span><span class="p">(</span>
        <span class="n">summary_result</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Scattermap</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper function to create the summary information to plot on top of map type plots.</span>

<span class="sd">        We use the summary result calculated through the support functions module to create a trace which contains</span>
<span class="sd">        the summary information for each source location.</span>

<span class="sd">        Args:</span>
<span class="sd">            summary_result (pd.DataFrame): DataFrame containing the summary information for each source location.</span>

<span class="sd">        Returns:</span>
<span class="sd">            summary_trace (go.Scattermap): Trace with summary information to plot on top of map type plots.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">summary_text_values</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Source ID&lt;/b&gt;: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&lt;br&gt;&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;(Lon, Lat, Alt)&lt;/b&gt; ([deg], [deg], [m]):&lt;br&gt;&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.7f</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.7f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">altitude</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&lt;br&gt;&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Height&lt;/b&gt;: </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">height</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> [m]&lt;br&gt;&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Median emission rate&lt;/b&gt;: </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">median_estimate</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> [kg/hr]&lt;br&gt;&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;2.5% quantile&lt;/b&gt;: </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">quantile_025</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> [kg/hr]&lt;br&gt;&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;97.5% quantile&lt;/b&gt;: </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">quantile_975</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> [kg/hr]&lt;br&gt;&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;IQR&lt;/b&gt;: </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">iqr_estimate</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> [kg/hr]&lt;br&gt;&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Blob present during&lt;/b&gt;: &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">absolute_count_iterations</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> iterations&lt;br&gt;&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Blob likelihood&lt;/b&gt;: </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">blob_likelihood</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&lt;br&gt;&quot;</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">summary_result</span><span class="o">.</span><span class="n">index</span>
        <span class="p">]</span>

        <span class="n">summary_trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scattermap</span><span class="p">(</span>
            <span class="n">lat</span><span class="o">=</span><span class="n">summary_result</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
            <span class="n">lon</span><span class="o">=</span><span class="n">summary_result</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">scattermap</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span>
            <span class="n">text</span><span class="o">=</span><span class="n">summary_text_values</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Summary&quot;</span><span class="p">,</span>
            <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">summary_trace</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="pyelq.plotting.plot.Plot.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Using post init to set the default layout, not able to do this in attribute definition/initialization.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Using post init to set the default layout, not able to do this in attribute definition/initialization.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
            <span class="n">font</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;family&quot;</span><span class="p">:</span> <span class="s2">&quot;Futura&quot;</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
            <span class="n">title</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>
            <span class="n">title_font</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">},</span>
            <span class="n">xaxis</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="s2">&quot;outside&quot;</span><span class="p">,</span> <span class="s2">&quot;showline&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
            <span class="n">yaxis</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="s2">&quot;outside&quot;</span><span class="p">,</span> <span class="s2">&quot;showline&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
            <span class="n">legend</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span>
                <span class="s2">&quot;yanchor&quot;</span><span class="p">:</span> <span class="s2">&quot;middle&quot;</span><span class="p">,</span>
                <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                <span class="s2">&quot;xanchor&quot;</span><span class="p">:</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span>
                <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span>
                <span class="s2">&quot;font&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">},</span>
            <span class="p">},</span>
        <span class="p">)</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.plotting.plot.Plot.show_all" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show_all</span><span class="p">(</span><span class="n">renderer</span><span class="o">=</span><span class="s1">&#39;browser&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Show all the figures which are in the figure dictionary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>renderer</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default renderer to use when showing the figures.</p>
              </div>
            </td>
            <td>
                  <code>&#39;browser&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">show_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="s2">&quot;browser&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show all the figures which are in the figure dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        renderer (str, optional): Default renderer to use when showing the figures.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">fig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">renderer</span><span class="o">=</span><span class="n">renderer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.plotting.plot.Plot.plot_single_trace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_single_trace</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plotting a trace of a single variable.</p>
<p>Depending on the object to plot it creates a figure which is stored in the figure_dict attribute.
First it grabs all the specifics needed for the plot and then plots the trace.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>object_to_plot</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.Type">Type</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;SlabAndSpike&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.component.source_model.SlabAndSpike&lt;/code&gt;)" href="../../component/source_model/#pyelq.component.source_model.SlabAndSpike">SlabAndSpike</a>], <a class="autorefs autorefs-internal" title="&lt;code&gt;SourceModel&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.component.source_model.SourceModel&lt;/code&gt;)" href="../../component/source_model/#pyelq.component.source_model.SourceModel">SourceModel</a>, <span title="openmcmc.mcmc.MCMC">MCMC</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The object from which to plot a variable</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional key word arguments, e.g. burn_in, legend_group, show_legend, dict_key, used in
some specific plots but not applicable to all.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_single_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_to_plot</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">SlabAndSpike</span><span class="p">],</span> <span class="n">SourceModel</span><span class="p">,</span> <span class="n">MCMC</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting a trace of a single variable.</span>

<span class="sd">    Depending on the object to plot it creates a figure which is stored in the figure_dict attribute.</span>
<span class="sd">    First it grabs all the specifics needed for the plot and then plots the trace.</span>

<span class="sd">    Args:</span>
<span class="sd">        object_to_plot (Union[Type[SlabAndSpike], SourceModel, MCMC]): The object from which to plot a variable</span>
<span class="sd">        **kwargs (Any): Additional key word arguments, e.g. burn_in, legend_group, show_legend, dict_key, used in</span>
<span class="sd">            some specific plots but not applicable to all.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plot_specifics</span> <span class="o">=</span> <span class="n">create_trace_specifics</span><span class="p">(</span><span class="n">object_to_plot</span><span class="o">=</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">burn_in</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;burn_in&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_single_scatter</span><span class="p">(</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">x_values</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;x_values&quot;</span><span class="p">],</span>
        <span class="n">y_values</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;y_values&quot;</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
        <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">burn_in</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Burn in: </span><span class="si">{</span><span class="n">burn_in</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">SlabAndSpike</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">SourceModel</span><span class="p">):</span>
        <span class="n">prior_num_sources_on</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">object_to_plot</span><span class="o">.</span><span class="n">emission_rate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">object_to_plot</span><span class="o">.</span><span class="n">slab_probability</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span>
            <span class="n">y</span><span class="o">=</span><span class="n">prior_num_sources_on</span><span class="p">,</span>
            <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span>
            <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Prior sources &#39;on&#39;: </span><span class="si">{</span><span class="n">prior_num_sources_on</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;title_text&quot;</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;x_label&quot;</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;y_label&quot;</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;dict_key&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.plotting.plot.Plot.plot_trace_per_sensor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_trace_per_sensor</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">sensor_object</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plotting a trace of a single variable per sensor.</p>
<p>Depending on the object to plot it creates a figure which is stored in the figure_dict attribute.
First it grabs all the specifics needed for the plot and then plots the trace per sensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>object_to_plot</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;ErrorModel&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.component.error_model.ErrorModel&lt;/code&gt;)" href="../../component/error_model/#pyelq.component.error_model.ErrorModel">ErrorModel</a>, <a class="autorefs autorefs-internal" title="&lt;code&gt;PerSensor&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.component.offset.PerSensor&lt;/code&gt;)" href="../../component/offset/#pyelq.component.offset.PerSensor">PerSensor</a>, <span title="openmcmc.mcmc.MCMC">MCMC</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The object which to plot a variable from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sensor_object</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;SensorGroup&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.sensor.sensor.SensorGroup&lt;/code&gt;)" href="../../sensor/sensor/#pyelq.sensor.sensor.SensorGroup">SensorGroup</a>, <a class="autorefs autorefs-internal" title="&lt;code&gt;Sensor&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.sensor.sensor.Sensor&lt;/code&gt;)" href="../../sensor/sensor/#pyelq.sensor.sensor.Sensor">Sensor</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sensor object associated with the object_to_plot</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plot_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String specifying a line or box plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional key word arguments, e.g. burn_in, legend_group, show_legend, dict_key, used in
some specific plots but not applicable to all.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_trace_per_sensor</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">object_to_plot</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ErrorModel</span><span class="p">,</span> <span class="n">PerSensor</span><span class="p">,</span> <span class="n">MCMC</span><span class="p">],</span>
    <span class="n">sensor_object</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SensorGroup</span><span class="p">,</span> <span class="n">Sensor</span><span class="p">],</span>
    <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting a trace of a single variable per sensor.</span>

<span class="sd">    Depending on the object to plot it creates a figure which is stored in the figure_dict attribute.</span>
<span class="sd">    First it grabs all the specifics needed for the plot and then plots the trace per sensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        object_to_plot (Union[ErrorModel, PerSensor, MCMC]): The object which to plot a variable from</span>
<span class="sd">        sensor_object (Union[SensorGroup, Sensor]): Sensor object associated with the object_to_plot</span>
<span class="sd">        plot_type (str): String specifying a line or box plot.</span>
<span class="sd">        **kwargs (Any): Additional key word arguments, e.g. burn_in, legend_group, show_legend, dict_key, used in</span>
<span class="sd">            some specific plots but not applicable to all.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sensor_object</span><span class="p">,</span> <span class="n">Sensor</span><span class="p">):</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">SensorGroup</span><span class="p">()</span>
        <span class="n">temp</span><span class="o">.</span><span class="n">add_sensor</span><span class="p">(</span><span class="n">sensor_object</span><span class="p">)</span>
        <span class="n">sensor_object</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="n">plot_specifics</span> <span class="o">=</span> <span class="n">create_plot_specifics</span><span class="p">(</span>
        <span class="n">object_to_plot</span><span class="o">=</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">sensor_object</span><span class="o">=</span><span class="n">sensor_object</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="n">burn_in</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;burn_in&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">sensor_idx</span><span class="p">,</span> <span class="n">sensor_key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">color_idx</span> <span class="o">=</span> <span class="n">sensor_idx</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">color_map</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">sensor_object</span><span class="o">.</span><span class="n">color_map</span><span class="p">[</span><span class="n">color_idx</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;plot_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_single_scatter</span><span class="p">(</span>
                <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                <span class="n">x_values</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;x_values&quot;</span><span class="p">],</span>
                <span class="n">y_values</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;y_values&quot;</span><span class="p">][</span><span class="n">sensor_idx</span><span class="p">,</span> <span class="p">:],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">sensor_key</span><span class="p">,</span>
                <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;plot_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;box&quot;</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_single_box</span><span class="p">(</span>
                <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                <span class="n">y_values</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;y_values&quot;</span><span class="p">][</span><span class="n">sensor_idx</span><span class="p">,</span> <span class="n">burn_in</span><span class="p">:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">sensor_key</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">burn_in</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;plot_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Burn in: </span><span class="si">{</span><span class="n">burn_in</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;title_text&quot;</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;x_label&quot;</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;y_label&quot;</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">plot_specifics</span><span class="p">[</span><span class="s2">&quot;dict_key&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.plotting.plot.Plot.plot_fitted_values_per_sensor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_fitted_values_per_sensor</span><span class="p">(</span><span class="n">mcmc_object</span><span class="p">,</span> <span class="n">sensor_object</span><span class="p">,</span> <span class="n">background_model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">burn_in</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plot the fitted values from the mcmc object against time, also shows the estimated background when inputted.</p>
<p>Based on the inputs it plots the results of the mcmc analysis, being the fitted values of the concentration
measurements together with the 10th and 90th quantile lines to show the goodness of fit of the estimates.</p>
<p>The created figure is stored in the figure_dict attribute.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mcmc_object</code>
            </td>
            <td>
                  <code><span title="openmcmc.mcmc.MCMC">MCMC</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MCMC object which contains the fitted values in the store attribute of the object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sensor_object</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;SensorGroup&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.sensor.sensor.SensorGroup&lt;/code&gt;)" href="../../sensor/sensor/#pyelq.sensor.sensor.SensorGroup">SensorGroup</a>, <a class="autorefs autorefs-internal" title="&lt;code&gt;Sensor&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.sensor.sensor.Sensor&lt;/code&gt;)" href="../../sensor/sensor/#pyelq.sensor.sensor.Sensor">Sensor</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sensor object associated with the object_to_plot</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>background_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;TemporalBackground&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.component.background.TemporalBackground&lt;/code&gt;)" href="../../component/background/#pyelq.component.background.TemporalBackground">TemporalBackground</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Background model containing the estimated background.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>burn_in</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of burn-in iterations to discard before calculating the quantiles
and median. Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_fitted_values_per_sensor</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">mcmc_object</span><span class="p">:</span> <span class="n">MCMC</span><span class="p">,</span>
    <span class="n">sensor_object</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SensorGroup</span><span class="p">,</span> <span class="n">Sensor</span><span class="p">],</span>
    <span class="n">background_model</span><span class="p">:</span> <span class="n">TemporalBackground</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">burn_in</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the fitted values from the mcmc object against time, also shows the estimated background when inputted.</span>

<span class="sd">    Based on the inputs it plots the results of the mcmc analysis, being the fitted values of the concentration</span>
<span class="sd">    measurements together with the 10th and 90th quantile lines to show the goodness of fit of the estimates.</span>

<span class="sd">    The created figure is stored in the figure_dict attribute.</span>

<span class="sd">    Args:</span>
<span class="sd">        mcmc_object (MCMC): MCMC object which contains the fitted values in the store attribute of the object.</span>
<span class="sd">        sensor_object (Union[SensorGroup, Sensor]): Sensor object associated with the object_to_plot</span>
<span class="sd">        background_model (TemporalBackground, optional): Background model containing the estimated background.</span>
<span class="sd">        burn_in (int, optional): Number of burn-in iterations to discard before calculating the quantiles</span>
<span class="sd">            and median. Defaults to 0.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mcmc_object</span><span class="o">.</span><span class="n">store</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing fitted values (&#39;y&#39;) in mcmc_store_object&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sensor_object</span><span class="p">,</span> <span class="n">Sensor</span><span class="p">):</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">SensorGroup</span><span class="p">()</span>
        <span class="n">temp</span><span class="o">.</span><span class="n">add_sensor</span><span class="p">(</span><span class="n">sensor_object</span><span class="p">)</span>
        <span class="n">sensor_object</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

    <span class="n">y_values_overall</span> <span class="o">=</span> <span class="n">mcmc_object</span><span class="o">.</span><span class="n">store</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
    <span class="n">dict_key</span> <span class="o">=</span> <span class="s2">&quot;fitted_values&quot;</span>
    <span class="n">title_text</span> <span class="o">=</span> <span class="s2">&quot;Observations and Predicted Model Values Against Time&quot;</span>
    <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Time&quot;</span>
    <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Concentration (ppm)&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">sensor_idx</span><span class="p">,</span> <span class="n">sensor_key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">plot_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">sensor_index</span> <span class="o">==</span> <span class="n">sensor_idx</span><span class="p">)</span>

        <span class="n">x_values</span> <span class="o">=</span> <span class="n">sensor_object</span><span class="p">[</span><span class="n">sensor_key</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
        <span class="n">y_values</span> <span class="o">=</span> <span class="n">y_values_overall</span><span class="p">[</span><span class="n">plot_idx</span><span class="p">,</span> <span class="n">burn_in</span><span class="p">:]</span>

        <span class="n">color_idx</span> <span class="o">=</span> <span class="n">sensor_idx</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">color_map</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">sensor_object</span><span class="o">.</span><span class="n">color_map</span><span class="p">[</span><span class="n">color_idx</span><span class="p">]</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_quantiles_from_array</span><span class="p">(</span>
            <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">x_values</span><span class="o">=</span><span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="o">=</span><span class="n">y_values</span><span class="p">,</span> <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">sensor_key</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">background_model</span><span class="p">,</span> <span class="n">TemporalBackground</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_quantiles_from_array</span><span class="p">(</span>
            <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
            <span class="n">x_values</span><span class="o">=</span><span class="n">background_model</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
            <span class="n">y_values</span><span class="o">=</span><span class="n">background_model</span><span class="o">.</span><span class="n">bg</span><span class="p">,</span>
            <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgb(186, 186, 186)&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Background&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">for_each_trace</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">trace</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">trace</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Background&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">trace</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Median for Background&quot;</span> <span class="k">else</span> <span class="p">()</span>
            <span class="p">),</span>
        <span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">sensor_object</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">color_map</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
        <span class="n">yref</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
        <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
        <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">},</span>
        <span class="n">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="n">showarrow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">borderpad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
        <span class="n">bordercolor</span><span class="o">=</span><span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;&lt;b&gt;Point&lt;/b&gt;: Real observation&lt;br&gt;&lt;b&gt;Line&lt;/b&gt;: Predicted Value&lt;br&gt;&lt;b&gt;Shading&lt;/b&gt;: &quot;</span> <span class="o">+</span> <span class="s2">&quot;Quantiles 10-90&quot;</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title_text</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">x_label</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">y_label</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.plotting.plot.Plot.plot_emission_rate_estimates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_emission_rate_estimates</span><span class="p">(</span><span class="n">source_model_object</span><span class="p">,</span> <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plot the emission rate estimates source model object against MCMC iteration.</p>
<p>Based on the inputs it plots the results of the mcmc analysis, being the estimated emission rate values for
each source location together with the total emissions estimate, which is the sum over all source locations.</p>
<p>The created figure is stored in the figure_dict attribute.</p>
<p>After the loop over all sources we add an empty trace to have the legend entry and desired legend group
behaviour.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source_model_object</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;SourceModel&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.component.source_model.SourceModel&lt;/code&gt;)" href="../../component/source_model/#pyelq.component.source_model.SourceModel">SourceModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Source model object which contains the estimated emission rate estimates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_axis_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String to indicate whether the y-axis should be linear of log scale.</p>
              </div>
            </td>
            <td>
                  <code>&#39;linear&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional key word arguments, e.g. burn_in, dict_key, used in some specific plots but not
applicable to all.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_emission_rate_estimates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_model_object</span><span class="p">,</span> <span class="n">y_axis_type</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the emission rate estimates source model object against MCMC iteration.</span>

<span class="sd">    Based on the inputs it plots the results of the mcmc analysis, being the estimated emission rate values for</span>
<span class="sd">    each source location together with the total emissions estimate, which is the sum over all source locations.</span>

<span class="sd">    The created figure is stored in the figure_dict attribute.</span>

<span class="sd">    After the loop over all sources we add an empty trace to have the legend entry and desired legend group</span>
<span class="sd">    behaviour.</span>

<span class="sd">    Args:</span>
<span class="sd">        source_model_object (SourceModel): Source model object which contains the estimated emission rate estimates.</span>
<span class="sd">        y_axis_type (str, optional): String to indicate whether the y-axis should be linear of log scale.</span>
<span class="sd">        **kwargs (Any): Additional key word arguments, e.g. burn_in, dict_key, used in some specific plots but not</span>
<span class="sd">            applicable to all.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_emissions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">source_model_object</span><span class="o">.</span><span class="n">emission_rate</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">total_emissions</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

    <span class="n">burn_in</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;burn_in&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">dict_key</span> <span class="o">=</span> <span class="s2">&quot;estimated_values_plot&quot;</span>
    <span class="n">title_text</span> <span class="o">=</span> <span class="s2">&quot;Estimated Values of Sources With Respect to MCMC Iterations&quot;</span>
    <span class="n">x_label</span> <span class="o">=</span> <span class="n">MCMC_ITERATION_NUMBER_LITERAL</span>
    <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Estimated Emission&lt;br&gt;Values (kg/hr)&quot;</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_single_scatter</span><span class="p">(</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">x_values</span><span class="o">=</span><span class="n">x_values</span><span class="p">,</span>
        <span class="n">y_values</span><span class="o">=</span><span class="n">total_emissions</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgb(239, 85, 59)&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Total Site Emissions&quot;</span><span class="p">,</span>
        <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
        <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">source_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">source_model_object</span><span class="o">.</span><span class="n">emission_rate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">y_values</span> <span class="o">=</span> <span class="n">source_model_object</span><span class="o">.</span><span class="n">emission_rate</span><span class="p">[</span><span class="n">source_idx</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">if</span> <span class="n">source_model_object</span><span class="o">.</span><span class="n">individual_source_labels</span><span class="p">[</span><span class="n">source_idx</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">source_label</span> <span class="o">=</span> <span class="n">source_model_object</span><span class="o">.</span><span class="n">individual_source_labels</span><span class="p">[</span><span class="n">source_idx</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">source_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Source </span><span class="si">{</span><span class="n">source_idx</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_single_scatter</span><span class="p">(</span>
            <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
            <span class="n">x_values</span><span class="o">=</span><span class="n">x_values</span><span class="p">,</span>
            <span class="n">y_values</span><span class="o">=</span><span class="n">y_values</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">RGB_LIGHT_BLUE</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">source_label</span><span class="p">,</span>
            <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
            <span class="n">show_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">legend_group</span><span class="o">=</span><span class="s2">&quot;Source traces&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_single_scatter</span><span class="p">(</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">x_values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">None</span><span class="p">]),</span>
        <span class="n">y_values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">None</span><span class="p">]),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">RGB_LIGHT_BLUE</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Source traces&quot;</span><span class="p">,</span>
        <span class="n">burn_in</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">burn_in</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Burn in: </span><span class="si">{</span><span class="n">burn_in</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span>
        <span class="n">yref</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
        <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
        <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="n">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">},</span>
        <span class="n">showarrow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">borderpad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
        <span class="n">bordercolor</span><span class="o">=</span><span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;&lt;b&gt;Total Site Emissions&lt;/b&gt; are&lt;br&gt;the sum of all estimated&lt;br&gt;&quot;</span>
            <span class="s2">&quot;emission rates at a given&lt;br&gt;iteration number.&quot;</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title_text</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">x_label</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_standoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">automargin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="n">y_label</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_axis_type</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">dict_key</span> <span class="o">=</span> <span class="s2">&quot;log_estimated_values_plot&quot;</span>
    <span class="k">elif</span> <span class="n">y_axis_type</span> <span class="o">!=</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Only linear or log y axis type is allowed, </span><span class="si">{</span><span class="n">y_axis_type</span><span class="si">}</span><span class="s2"> was currently specified.&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.plotting.plot.Plot.create_empty_map_figure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_empty_map_figure</span><span class="p">(</span><span class="n">dict_key</span><span class="o">=</span><span class="s1">&#39;map_plot&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creating an empty map figure to use when you want to add additional traces on a map.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dict_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String key for figure dictionary</p>
              </div>
            </td>
            <td>
                  <code>&#39;map_plot&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_empty_map_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;map_plot&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creating an empty map figure to use when you want to add additional traces on a map.</span>

<span class="sd">    Args:</span>
<span class="sd">        dict_key (str, optional): String key for figure dictionary</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Scattermap</span><span class="p">(),</span>
        <span class="n">layout</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;map_style&quot;</span><span class="p">:</span> <span class="s2">&quot;carto-positron&quot;</span><span class="p">,</span>
            <span class="s2">&quot;map_center_lat&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;map_center_lon&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;map_zoom&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.plotting.plot.Plot.plot_values_on_map" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_values_on_map</span><span class="p">(</span><span class="n">dict_key</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">aggregate_function</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plot values on a map based on coordinates.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dict_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sting key to use in the figure dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coordinates</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;LLA&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.coordinate_system.LLA&lt;/code&gt;)" href="../../coordinate_system/#pyelq.coordinate_system.LLA">LLA</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>LLA coordinates to use in plotting the values on the map</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array of values consistent with coordinates to plot on the map</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>aggregate_function</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function which to apply on the data in each hexagonal bin to
aggregate the data and visualise the result.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.sum">sum</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments for plotting behaviour (opacity, map_color_scale, num_hexagons,
show_positions)</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_values_on_map</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">dict_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span> <span class="n">LLA</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">aggregate_function</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot values on a map based on coordinates.</span>

<span class="sd">    Args:</span>
<span class="sd">        dict_key (str): Sting key to use in the figure dictionary</span>
<span class="sd">        coordinates (LLA): LLA coordinates to use in plotting the values on the map</span>
<span class="sd">        values (np.ndarray): Numpy array of values consistent with coordinates to plot on the map</span>
<span class="sd">        aggregate_function (Callable, optional): Function which to apply on the data in each hexagonal bin to</span>
<span class="sd">            aggregate the data and visualise the result.</span>
<span class="sd">        **kwargs (Any): Additional keyword arguments for plotting behaviour (opacity, map_color_scale, num_hexagons,</span>
<span class="sd">            show_positions)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">map_color_scale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;map_color_scale&quot;</span><span class="p">,</span> <span class="s2">&quot;YlOrRd&quot;</span><span class="p">)</span>
    <span class="n">num_hexagons</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;num_hexagons&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">show_positions</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;show_positions&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">latitude_check</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">is_regularly_spaced</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span>
    <span class="n">longitude_check</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">is_regularly_spaced</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">latitude_check</span> <span class="ow">and</span> <span class="n">longitude_check</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_empty_map_figure</span><span class="p">(</span><span class="n">dict_key</span><span class="o">=</span><span class="n">dict_key</span><span class="p">)</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="n">plot_regular_grid</span><span class="p">(</span>
            <span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
            <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
            <span class="n">map_color_scale</span><span class="o">=</span><span class="n">map_color_scale</span><span class="p">,</span>
            <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_hexagonal_grid</span><span class="p">(</span>
            <span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
            <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
            <span class="n">map_color_scale</span><span class="o">=</span><span class="n">map_color_scale</span><span class="p">,</span>
            <span class="n">num_hexagons</span><span class="o">=</span><span class="n">num_hexagons</span><span class="p">,</span>
            <span class="n">show_positions</span><span class="o">=</span><span class="n">show_positions</span><span class="p">,</span>
            <span class="n">aggregate_function</span><span class="o">=</span><span class="n">aggregate_function</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">map_style</span><span class="o">=</span><span class="s2">&quot;carto-positron&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>

    <span class="n">center_longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span>
    <span class="n">center_latitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;zoom&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">center_longitude</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">center_latitude</span><span class="p">}}</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="n">dict_key</span><span class="p">]</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.plotting.plot.Plot.plot_quantification_results_on_map" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_quantification_results_on_map</span><span class="p">(</span><span class="n">model_object</span><span class="p">,</span> <span class="n">source_model_to_plot_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_size_x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bin_size_y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">normalized_count_limit</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">burn_in</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">show_summary_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_fixed_source_locations</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Function to create a map with the quantification results of the model object.</p>
<p>This function takes the "SourceModel" object and calculates the statistics for the quantification results.
It then populates the figure dictionary with three different maps showing the normalized count,
median emission rate and the inter-quartile range of the emission rate estimates.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_object</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;ELQModel&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.model.ELQModel&lt;/code&gt;)" href="../../model/#pyelq.model.ELQModel">ELQModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ELQModel object containing the quantification results</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_model_to_plot_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Key to use in the model_object.components dictionary to access
the SourceModel object. If None, defaults to "sources_combined".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bin_size_x</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the bins in the x-direction. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bin_size_y</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the bins in the y-direction. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>normalized_count_limit</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Limit for the normalized count to show on the map.
Defaults to 0.005.</p>
              </div>
            </td>
            <td>
                  <code>0.005</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>burn_in</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of burn-in iterations to discard before calculating the statistics.
Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_summary_results</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to show the summary results on the map. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_fixed_source_locations</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to show the fixed sources location when present in one
of the sourcemaps. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_quantification_results_on_map</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model_object</span><span class="p">:</span> <span class="s2">&quot;ELQModel&quot;</span><span class="p">,</span>
    <span class="n">source_model_to_plot_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bin_size_x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">bin_size_y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">normalized_count_limit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">,</span>
    <span class="n">burn_in</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">show_summary_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_fixed_source_locations</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to create a map with the quantification results of the model object.</span>

<span class="sd">    This function takes the &quot;SourceModel&quot; object and calculates the statistics for the quantification results.</span>
<span class="sd">    It then populates the figure dictionary with three different maps showing the normalized count,</span>
<span class="sd">    median emission rate and the inter-quartile range of the emission rate estimates.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_object (ELQModel): ELQModel object containing the quantification results</span>
<span class="sd">        source_model_to_plot_key (str, optional): Key to use in the model_object.components dictionary to access</span>
<span class="sd">          the SourceModel object. If None, defaults to &quot;sources_combined&quot;.</span>
<span class="sd">        bin_size_x (float, optional): Size of the bins in the x-direction. Defaults to 1.</span>
<span class="sd">        bin_size_y (float, optional): Size of the bins in the y-direction. Defaults to 1.</span>
<span class="sd">        normalized_count_limit (float, optional): Limit for the normalized count to show on the map.</span>
<span class="sd">            Defaults to 0.005.</span>
<span class="sd">        burn_in (int, optional): Number of burn-in iterations to discard before calculating the statistics.</span>
<span class="sd">            Defaults to 0.</span>
<span class="sd">        show_summary_results (bool, optional): Flag to show the summary results on the map. Defaults to True.</span>
<span class="sd">        show_fixed_source_locations (bool, optional): Flag to show the fixed sources location when present in one</span>
<span class="sd">            of the sourcemaps. Defaults to True.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">source_model_to_plot_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">source_model_to_plot_key</span> <span class="o">=</span> <span class="s2">&quot;sources_combined&quot;</span>

    <span class="n">source_model</span> <span class="o">=</span> <span class="n">model_object</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">source_model_to_plot_key</span><span class="p">]</span>
    <span class="n">sensor_object</span> <span class="o">=</span> <span class="n">model_object</span><span class="o">.</span><span class="n">sensor_object</span>

    <span class="n">source_locations</span> <span class="o">=</span> <span class="n">source_model</span><span class="o">.</span><span class="n">all_source_locations</span>
    <span class="n">emission_rates</span> <span class="o">=</span> <span class="n">source_model</span><span class="o">.</span><span class="n">emission_rate</span>

    <span class="n">ref_latitude</span> <span class="o">=</span> <span class="n">source_locations</span><span class="o">.</span><span class="n">ref_latitude</span>
    <span class="n">ref_longitude</span> <span class="o">=</span> <span class="n">source_locations</span><span class="o">.</span><span class="n">ref_longitude</span>
    <span class="n">ref_altitude</span> <span class="o">=</span> <span class="n">source_locations</span><span class="o">.</span><span class="n">ref_altitude</span>

    <span class="n">datetime_min_string</span> <span class="o">=</span> <span class="n">sensor_object</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%b-%Y, %H:%M:%S&quot;</span><span class="p">)</span>
    <span class="n">datetime_max_string</span> <span class="o">=</span> <span class="n">sensor_object</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%b-%Y, %H:%M:%S&quot;</span><span class="p">)</span>

    <span class="n">result_weighted</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">normalized_count</span><span class="p">,</span> <span class="n">count_boolean</span><span class="p">,</span> <span class="n">enu_points</span><span class="p">,</span> <span class="n">summary_result</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">calculate_rectangular_statistics</span><span class="p">(</span>
            <span class="n">emission_rates</span><span class="o">=</span><span class="n">emission_rates</span><span class="p">,</span>
            <span class="n">source_locations</span><span class="o">=</span><span class="n">source_locations</span><span class="p">,</span>
            <span class="n">bin_size_x</span><span class="o">=</span><span class="n">bin_size_x</span><span class="p">,</span>
            <span class="n">bin_size_y</span><span class="o">=</span><span class="n">bin_size_y</span><span class="p">,</span>
            <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
            <span class="n">normalized_count_limit</span><span class="o">=</span><span class="n">normalized_count_limit</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">polygons</span> <span class="o">=</span> <span class="n">create_lla_polygons_from_xy_points</span><span class="p">(</span>
        <span class="n">points_array</span><span class="o">=</span><span class="n">enu_points</span><span class="p">,</span>
        <span class="n">ref_latitude</span><span class="o">=</span><span class="n">ref_latitude</span><span class="p">,</span>
        <span class="n">ref_longitude</span><span class="o">=</span><span class="n">ref_longitude</span><span class="p">,</span>
        <span class="n">ref_altitude</span><span class="o">=</span><span class="n">ref_altitude</span><span class="p">,</span>
        <span class="n">boolean_mask</span><span class="o">=</span><span class="n">count_boolean</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">show_summary_results</span><span class="p">:</span>
        <span class="n">summary_trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_summary_trace</span><span class="p">(</span><span class="n">summary_result</span><span class="o">=</span><span class="n">summary_result</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">create_empty_map_figure</span><span class="p">(</span><span class="n">dict_key</span><span class="o">=</span><span class="s2">&quot;count_map&quot;</span><span class="p">)</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">plot_polygons_on_map</span><span class="p">(</span>
        <span class="n">polygons</span><span class="o">=</span><span class="n">polygons</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="n">normalized_count</span><span class="p">[</span><span class="n">count_boolean</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;normalized_count&quot;</span><span class="p">,</span>
        <span class="n">colorbar</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Normalized Count&quot;</span><span class="p">,</span> <span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;h&quot;</span><span class="p">},</span>
        <span class="n">map_color_scale</span><span class="o">=</span><span class="s2">&quot;Bluered&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">map_style</span><span class="o">=</span><span class="s2">&quot;carto-positron&quot;</span><span class="p">,</span>
        <span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;zoom&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">ref_longitude</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">ref_latitude</span><span class="p">}},</span>
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Source location probability &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;(&gt;=</span><span class="si">{</span><span class="n">normalized_count_limit</span><span class="si">}</span><span class="s2">) for &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datetime_min_string</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">datetime_max_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">font_family</span><span class="o">=</span><span class="s2">&quot;Futura&quot;</span><span class="p">,</span>
        <span class="n">font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">sensor_object</span><span class="o">.</span><span class="n">plot_sensor_location</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">adjusted_result_weights</span> <span class="o">=</span> <span class="n">result_weighted</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">adjusted_result_weights</span><span class="p">[</span><span class="n">adjusted_result_weights</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="n">median_of_all_emissions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">adjusted_result_weights</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">create_empty_map_figure</span><span class="p">(</span><span class="n">dict_key</span><span class="o">=</span><span class="s2">&quot;median_map&quot;</span><span class="p">)</span>

    <span class="n">trace</span> <span class="o">=</span> <span class="n">plot_polygons_on_map</span><span class="p">(</span>
        <span class="n">polygons</span><span class="o">=</span><span class="n">polygons</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="n">median_of_all_emissions</span><span class="p">[</span><span class="n">count_boolean</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;median_emission&quot;</span><span class="p">,</span>
        <span class="n">colorbar</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Median Emission&quot;</span><span class="p">,</span> <span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;h&quot;</span><span class="p">},</span>
        <span class="n">map_color_scale</span><span class="o">=</span><span class="s2">&quot;Bluered&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">map_style</span><span class="o">=</span><span class="s2">&quot;carto-positron&quot;</span><span class="p">,</span>
        <span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;zoom&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">ref_longitude</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">ref_latitude</span><span class="p">}},</span>
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Median emission rate estimate for </span><span class="si">{</span><span class="n">datetime_min_string</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">datetime_max_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">font_family</span><span class="o">=</span><span class="s2">&quot;Futura&quot;</span><span class="p">,</span>
        <span class="n">font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">sensor_object</span><span class="o">.</span><span class="n">plot_sensor_location</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">iqr_of_all_emissions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanquantile</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">adjusted_result_weights</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanquantile</span><span class="p">(</span>
        <span class="n">a</span><span class="o">=</span><span class="n">adjusted_result_weights</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">create_empty_map_figure</span><span class="p">(</span><span class="n">dict_key</span><span class="o">=</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">)</span>

    <span class="n">trace</span> <span class="o">=</span> <span class="n">plot_polygons_on_map</span><span class="p">(</span>
        <span class="n">polygons</span><span class="o">=</span><span class="n">polygons</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="n">iqr_of_all_emissions</span><span class="p">[</span><span class="n">count_boolean</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;iqr_emission&quot;</span><span class="p">,</span>
        <span class="n">colorbar</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;IQR&quot;</span><span class="p">,</span> <span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;h&quot;</span><span class="p">},</span>
        <span class="n">map_color_scale</span><span class="o">=</span><span class="s2">&quot;Bluered&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">map_style</span><span class="o">=</span><span class="s2">&quot;carto-positron&quot;</span><span class="p">,</span>
        <span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;zoom&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">ref_longitude</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">ref_latitude</span><span class="p">}},</span>
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inter Quartile range (25%-75%) of emission rate &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;estimate for </span><span class="si">{</span><span class="n">datetime_min_string</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">datetime_max_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">font_family</span><span class="o">=</span><span class="s2">&quot;Futura&quot;</span><span class="p">,</span>
        <span class="n">font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">sensor_object</span><span class="o">.</span><span class="n">plot_sensor_location</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_fixed_source_locations</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">model_object</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;fixed&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)):</span>
                <span class="n">source_model_fixed</span> <span class="o">=</span> <span class="n">model_object</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">source_locations_fixed</span> <span class="o">=</span> <span class="n">source_model_fixed</span><span class="o">.</span><span class="n">all_source_locations</span>
                <span class="n">source_location_fixed_lla</span> <span class="o">=</span> <span class="n">source_locations_fixed</span><span class="o">.</span><span class="n">to_lla</span><span class="p">()</span>
                <span class="n">sources_lat</span> <span class="o">=</span> <span class="n">source_location_fixed_lla</span><span class="o">.</span><span class="n">latitude</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="n">sources_lon</span> <span class="o">=</span> <span class="n">source_location_fixed_lla</span><span class="o">.</span><span class="n">longitude</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="n">fixed_source_location_trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scattermap</span><span class="p">(</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">lon</span><span class="o">=</span><span class="n">sources_lon</span><span class="p">,</span>
                    <span class="n">lat</span><span class="o">=</span><span class="n">sources_lat</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Fixed source locations, </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">fixed_source_location_trace</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">fixed_source_location_trace</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">fixed_source_location_trace</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_summary_results</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">summary_trace</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;count_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">summary_trace</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;median_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">summary_trace</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure_dict</span><span class="p">[</span><span class="s2">&quot;iqr_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.plotting.plot.Plot.plot_coverage" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_coverage</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">couplings</span><span class="p">,</span> <span class="n">threshold_function</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">coverage_threshold</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">map_color_scale</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a coverage plot using the coverage function from Gaussian Plume.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>coordinates</code>
            </td>
            <td>
                  <code>LLA object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A LLA coordinate object containing a set of locations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>couplings</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The calculated values of coupling (The 'A matrix') for a set of wind data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threshold_function</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Callable function which returns some single value that defines the
                         maximum or 'threshold' coupling. Examples: np.quantile(q=0.9),
                         np.max, np.mean. Defaults to np.max.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.max">max</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coverage_threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The threshold value of the estimated emission rate which is
                                  considered to be within the coverage. Defaults to 6 kg/hr.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>opacity</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The opacity of the grid cells when they are plotted.</p>
              </div>
            </td>
            <td>
                  <code>0.8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>map_color_scale</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string which defines which plotly colour scale should be used when plotting
                   the values.</p>
              </div>
            </td>
            <td>
                  <code>&#39;jet&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_coverage</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">coordinates</span><span class="p">:</span> <span class="n">LLA</span><span class="p">,</span>
    <span class="n">couplings</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">threshold_function</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span>
    <span class="n">coverage_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">opacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
    <span class="n">map_color_scale</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a coverage plot using the coverage function from Gaussian Plume.</span>

<span class="sd">    Args:</span>
<span class="sd">        coordinates (LLA object): A LLA coordinate object containing a set of locations.</span>
<span class="sd">        couplings (np.array): The calculated values of coupling (The &#39;A matrix&#39;) for a set of wind data.</span>
<span class="sd">        threshold_function (Callable, optional): Callable function which returns some single value that defines the</span>
<span class="sd">                                     maximum or &#39;threshold&#39; coupling. Examples: np.quantile(q=0.9),</span>
<span class="sd">                                     np.max, np.mean. Defaults to np.max.</span>
<span class="sd">        coverage_threshold (float, optional): The threshold value of the estimated emission rate which is</span>
<span class="sd">                                              considered to be within the coverage. Defaults to 6 kg/hr.</span>
<span class="sd">        opacity (float): The opacity of the grid cells when they are plotted.</span>
<span class="sd">        map_color_scale (str): The string which defines which plotly colour scale should be used when plotting</span>
<span class="sd">                               the values.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coverage_values</span> <span class="o">=</span> <span class="n">GaussianPlume</span><span class="p">(</span><span class="n">source_map</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">compute_coverage</span><span class="p">(</span>
        <span class="n">couplings</span><span class="o">=</span><span class="n">couplings</span><span class="p">,</span> <span class="n">threshold_function</span><span class="o">=</span><span class="n">threshold_function</span><span class="p">,</span> <span class="n">coverage_threshold</span><span class="o">=</span><span class="n">coverage_threshold</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plot_values_on_map</span><span class="p">(</span>
        <span class="n">dict_key</span><span class="o">=</span><span class="s2">&quot;coverage_map&quot;</span><span class="p">,</span>
        <span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="n">coverage_values</span><span class="p">,</span>
        <span class="n">aggregate_function</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
        <span class="n">map_color_scale</span><span class="o">=</span><span class="n">map_color_scale</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyelq.plotting.plot.Plot.create_summary_trace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_summary_trace</span><span class="p">(</span><span class="n">summary_result</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Helper function to create the summary information to plot on top of map type plots.</p>
<p>We use the summary result calculated through the support functions module to create a trace which contains
the summary information for each source location.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>summary_result</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing the summary information for each source location.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>summary_trace</code></td>            <td>
                  <code><span title="plotly.graph_objects.Scattermap">Scattermap</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Trace with summary information to plot on top of map type plots.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_summary_trace</span><span class="p">(</span>
    <span class="n">summary_result</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Scattermap</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper function to create the summary information to plot on top of map type plots.</span>

<span class="sd">    We use the summary result calculated through the support functions module to create a trace which contains</span>
<span class="sd">    the summary information for each source location.</span>

<span class="sd">    Args:</span>
<span class="sd">        summary_result (pd.DataFrame): DataFrame containing the summary information for each source location.</span>

<span class="sd">    Returns:</span>
<span class="sd">        summary_trace (go.Scattermap): Trace with summary information to plot on top of map type plots.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">summary_text_values</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Source ID&lt;/b&gt;: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&lt;br&gt;&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;(Lon, Lat, Alt)&lt;/b&gt; ([deg], [deg], [m]):&lt;br&gt;&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.7f</span><span class="si">}</span><span class="s2">, &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.7f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">altitude</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&lt;br&gt;&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Height&lt;/b&gt;: </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">height</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> [m]&lt;br&gt;&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Median emission rate&lt;/b&gt;: </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">median_estimate</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> [kg/hr]&lt;br&gt;&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;2.5% quantile&lt;/b&gt;: </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">quantile_025</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> [kg/hr]&lt;br&gt;&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;97.5% quantile&lt;/b&gt;: </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">quantile_975</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> [kg/hr]&lt;br&gt;&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;IQR&lt;/b&gt;: </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">iqr_estimate</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> [kg/hr]&lt;br&gt;&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Blob present during&lt;/b&gt;: &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">absolute_count_iterations</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> iterations&lt;br&gt;&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Blob likelihood&lt;/b&gt;: </span><span class="si">{</span><span class="n">summary_result</span><span class="o">.</span><span class="n">blob_likelihood</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&lt;br&gt;&quot;</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">summary_result</span><span class="o">.</span><span class="n">index</span>
    <span class="p">]</span>

    <span class="n">summary_trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scattermap</span><span class="p">(</span>
        <span class="n">lat</span><span class="o">=</span><span class="n">summary_result</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
        <span class="n">lon</span><span class="o">=</span><span class="n">summary_result</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">scattermap</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span>
        <span class="n">text</span><span class="o">=</span><span class="n">summary_text_values</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Summary&quot;</span><span class="p">,</span>
        <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">summary_trace</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="pyelq.plotting.plot.lighter_rgb" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lighter_rgb</span><span class="p">(</span><span class="n">rbg_string</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Takes in an RGB string and returns a lighter version of this colour.</p>
<p>The colour is made lighter by increasing the magnitude of the RGB values by half of the difference between the
original value and the number 255.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rbg_string</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An RGB string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lighter_rgb</span><span class="p">(</span><span class="n">rbg_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Takes in an RGB string and returns a lighter version of this colour.</span>

<span class="sd">    The colour is made lighter by increasing the magnitude of the RGB values by half of the difference between the</span>
<span class="sd">    original value and the number 255.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        rbg_string (str): An RGB string.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rbg_string</span> <span class="o">=</span> <span class="n">rbg_string</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">rbg_string</span> <span class="o">=</span> <span class="n">rbg_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">rbg_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">colors_out</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">color</span> <span class="o">+</span> <span class="p">((</span><span class="mi">255</span> <span class="o">-</span> <span class="n">color</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">))),</span> <span class="mi">255</span><span class="p">)</span>
        <span class="n">colors_out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;rgb(</span><span class="si">{</span><span class="n">colors_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">colors_out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">colors_out</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyelq.plotting.plot.plot_quantiles_from_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_quantiles_from_array</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">,</span> <span class="n">quantiles</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plot quantiles over y-values against x-values.</p>
<p>Assuming x-values have size N and y-values have size [N x M] where the second dimension is the dimension to
calculate the quantiles over.</p>
<p>Will plot the median of the y-values as a solid line and a filled area between the lower and upper specified
quantile.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fig</code>
            </td>
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure to add the traces on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_values</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="pandas.arrays.DatetimeArray">DatetimeArray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array containing the x-values to plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_values</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array containing the y-values to calculate the quantiles for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quantiles</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="tuple">tuple</span>, <span title="list">list</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values of upper and lower quantile to plot in range (0-100)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>RGB string specifying color for quantile fill plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional string name to show in the legend.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>fig</code></td>            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure with the quantile filled traces and median trace added on it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_quantiles_from_array</span><span class="p">(</span>
    <span class="n">fig</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span>
    <span class="n">x_values</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">DatetimeArray</span><span class="p">],</span>
    <span class="n">y_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">quantiles</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot quantiles over y-values against x-values.</span>

<span class="sd">    Assuming x-values have size N and y-values have size [N x M] where the second dimension is the dimension to</span>
<span class="sd">    calculate the quantiles over.</span>

<span class="sd">    Will plot the median of the y-values as a solid line and a filled area between the lower and upper specified</span>
<span class="sd">    quantile.</span>

<span class="sd">    Args:</span>
<span class="sd">        fig (go.Figure): Plotly figure to add the traces on.</span>
<span class="sd">        x_values (Union[np.ndarray, pd.arrays.DatetimeArray]): Numpy array containing the x-values to plot.</span>
<span class="sd">        y_values (np.ndarray): Numpy array containing the y-values to calculate the quantiles for.</span>
<span class="sd">        quantiles (Union[tuple, list, np.ndarray]): Values of upper and lower quantile to plot in range (0-100)</span>
<span class="sd">        color (str): RGB string specifying color for quantile fill plot.</span>
<span class="sd">        name (str, optional): Optional string name to show in the legend.</span>

<span class="sd">    Returns:</span>
<span class="sd">         fig (go.Figure): Plotly figure with the quantile filled traces and median trace added on it.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">color_fill</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;rgba</span><span class="si">{</span><span class="n">color</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, 0.3)&quot;</span>

    <span class="n">median_trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x_values</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">},</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Median for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">legendgroup</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">lower_quantile_trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x_values</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">y_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">quantiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">),</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color_fill</span><span class="p">},</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">quantiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">% quantile&quot;</span><span class="p">,</span>
        <span class="n">legendgroup</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">upper_quantile_trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x_values</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">y_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">quantiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">),</span>
        <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;tonexty&quot;</span><span class="p">,</span>
        <span class="n">fillcolor</span><span class="o">=</span><span class="n">color_fill</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color_fill</span><span class="p">},</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">quantiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">% quantile&quot;</span><span class="p">,</span>
        <span class="n">legendgroup</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">median_trace</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">lower_quantile_trace</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">upper_quantile_trace</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyelq.plotting.plot.create_trace_specifics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_trace_specifics</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Specification of different traces of single variables.</p>
<p>Provides all details for plots where we want to plot a single variable as a line plot. Based on the object_to_plot
we select the correct plot to show.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>object_to_plot</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.Type">Type</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;SlabAndSpike&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.component.source_model.SlabAndSpike&lt;/code&gt;)" href="../../component/source_model/#pyelq.component.source_model.SlabAndSpike">SlabAndSpike</a>], <a class="autorefs autorefs-internal" title="&lt;code&gt;SourceModel&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.component.source_model.SourceModel&lt;/code&gt;)" href="../../component/source_model/#pyelq.component.source_model.SourceModel">SourceModel</a>, <span title="openmcmc.mcmc.MCMC">MCMC</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Object which we want to plot a single
variable from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional key word arguments, e.g. burn_in or dict_key, used in some specific plots but not
applicable to all.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with the following key/values:
x_values (Union[np.ndarray, pd.arrays.DatetimeArray]): Array containing the x-values to plot.
y_values (np.ndarray): Numpy array containing the y-values to use in plotting.
dict_key (str): String key associated with this plot to be used in the figure_dict attribute of the Plot
    class.
title_text (str): String title of the plot.
x_label (str): String label of x-axis.
y_label (str) : String label of y-axis.
name (str): String name to show in the legend.
color (str): RGB string specifying color for plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When no specifics are defined for the inputted object to plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_trace_specifics</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">SlabAndSpike</span><span class="p">],</span> <span class="n">SourceModel</span><span class="p">,</span> <span class="n">MCMC</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specification of different traces of single variables.</span>

<span class="sd">    Provides all details for plots where we want to plot a single variable as a line plot. Based on the object_to_plot</span>
<span class="sd">    we select the correct plot to show.</span>

<span class="sd">    Args:</span>
<span class="sd">        object_to_plot (Union[Type[SlabAndSpike], SourceModel, MCMC]): Object which we want to plot a single</span>
<span class="sd">            variable from</span>
<span class="sd">        **kwargs (Any): Additional key word arguments, e.g. burn_in or dict_key, used in some specific plots but not</span>
<span class="sd">            applicable to all.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary with the following key/values:</span>
<span class="sd">            x_values (Union[np.ndarray, pd.arrays.DatetimeArray]): Array containing the x-values to plot.</span>
<span class="sd">            y_values (np.ndarray): Numpy array containing the y-values to use in plotting.</span>
<span class="sd">            dict_key (str): String key associated with this plot to be used in the figure_dict attribute of the Plot</span>
<span class="sd">                class.</span>
<span class="sd">            title_text (str): String title of the plot.</span>
<span class="sd">            x_label (str): String label of x-axis.</span>
<span class="sd">            y_label (str) : String label of y-axis.</span>
<span class="sd">            name (str): String name to show in the legend.</span>
<span class="sd">            color (str): RGB string specifying color for plot.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: When no specifics are defined for the inputted object to plot.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">SourceModel</span><span class="p">):</span>
        <span class="n">dict_key</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;dict_key&quot;</span><span class="p">,</span> <span class="s2">&quot;number_of_sources_plot&quot;</span><span class="p">)</span>
        <span class="n">title_text</span> <span class="o">=</span> <span class="s2">&quot;Number of Sources &#39;on&#39; against MCMC iterations&quot;</span>
        <span class="n">x_label</span> <span class="o">=</span> <span class="n">MCMC_ITERATION_NUMBER_LITERAL</span>
        <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Number of Sources &#39;on&#39;&quot;</span>
        <span class="n">y_values</span> <span class="o">=</span> <span class="n">object_to_plot</span><span class="o">.</span><span class="n">number_on_sources</span>
        <span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">y_values</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;rgb(248, 156, 116)&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Number of Sources &#39;on&#39;&quot;</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">MCMC</span><span class="p">):</span>
        <span class="n">dict_key</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;dict_key&quot;</span><span class="p">,</span> <span class="s2">&quot;log_posterior_plot&quot;</span><span class="p">)</span>
        <span class="n">title_text</span> <span class="o">=</span> <span class="s2">&quot;Log posterior values against MCMC iterations&quot;</span>
        <span class="n">x_label</span> <span class="o">=</span> <span class="n">MCMC_ITERATION_NUMBER_LITERAL</span>
        <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Log Posterior&lt;br&gt;Value&quot;</span>
        <span class="n">y_values</span> <span class="o">=</span> <span class="n">object_to_plot</span><span class="o">.</span><span class="n">store</span><span class="p">[</span><span class="s2">&quot;log_post&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">y_values</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">RGB_LIGHT_BLUE</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Log Posterior&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;burn_in&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Burn in is not specified for the Log Posterior plot, are you sure this is correct?&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No values to plot&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;x_values&quot;</span><span class="p">:</span> <span class="n">x_values</span><span class="p">,</span>
        <span class="s2">&quot;y_values&quot;</span><span class="p">:</span> <span class="n">y_values</span><span class="p">,</span>
        <span class="s2">&quot;dict_key&quot;</span><span class="p">:</span> <span class="n">dict_key</span><span class="p">,</span>
        <span class="s2">&quot;title_text&quot;</span><span class="p">:</span> <span class="n">title_text</span><span class="p">,</span>
        <span class="s2">&quot;x_label&quot;</span><span class="p">:</span> <span class="n">x_label</span><span class="p">,</span>
        <span class="s2">&quot;y_label&quot;</span><span class="p">:</span> <span class="n">y_label</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyelq.plotting.plot.create_plot_specifics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_plot_specifics</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">sensor_object</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Specification of different traces where we want to plot a trace for each sensor.</p>
<p>Provides all details for plots where we want to plot a single variable for each sensor as a line or box plot.
Based on the object_to_plot we select the correct plot to show.</p>
<p>When plotting the MCMC Observations and Predicted Model Values Against Time plot we are assuming time axis is the
same for all sensors w.r.t. the fitted values from the MCMC store attribute, so we are only using the time axis
from the first sensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>object_to_plot</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;ErrorModel&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.component.error_model.ErrorModel&lt;/code&gt;)" href="../../component/error_model/#pyelq.component.error_model.ErrorModel">ErrorModel</a>, <a class="autorefs autorefs-internal" title="&lt;code&gt;PerSensor&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.component.offset.PerSensor&lt;/code&gt;)" href="../../component/offset/#pyelq.component.offset.PerSensor">PerSensor</a>, <span title="openmcmc.mcmc.MCMC">MCMC</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Object which we want to plot a single variable from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sensor_object</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;SensorGroup&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pyelq.sensor.sensor.SensorGroup&lt;/code&gt;)" href="../../sensor/sensor/#pyelq.sensor.sensor.SensorGroup">SensorGroup</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SensorGroup object associated with the object_to_plot</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plot_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String specifying either a line or a box plot.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional key word arguments, e.g. burn_in or dict_key, used in some specific plots but not
applicable to all.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with the following key/values:
x_values (Union[np.ndarray, pd.arrays.DatetimeArray]): Array containing the x-values to plot.
y_values (np.ndarray): Numpy array containing the y-values to use in plotting.
dict_key (str): String key associated with this plot to be used in the figure_dict attribute of the
    Plot class.
title_text (str): String title of the plot.
x_label (str): String label of x-axis.
y_label (str): String label of y-axis.
plot_type (str): Type of plot which needs to be generated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When no specifics are defined for the inputted object to plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_plot_specifics</span><span class="p">(</span>
    <span class="n">object_to_plot</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ErrorModel</span><span class="p">,</span> <span class="n">PerSensor</span><span class="p">,</span> <span class="n">MCMC</span><span class="p">],</span> <span class="n">sensor_object</span><span class="p">:</span> <span class="n">SensorGroup</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specification of different traces where we want to plot a trace for each sensor.</span>

<span class="sd">    Provides all details for plots where we want to plot a single variable for each sensor as a line or box plot.</span>
<span class="sd">    Based on the object_to_plot we select the correct plot to show.</span>

<span class="sd">    When plotting the MCMC Observations and Predicted Model Values Against Time plot we are assuming time axis is the</span>
<span class="sd">    same for all sensors w.r.t. the fitted values from the MCMC store attribute, so we are only using the time axis</span>
<span class="sd">    from the first sensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        object_to_plot (Union[ErrorModel, PerSensor, MCMC]): Object which we want to plot a single variable from</span>
<span class="sd">        sensor_object (SensorGroup): SensorGroup object associated with the object_to_plot</span>
<span class="sd">        plot_type (str, optional): String specifying either a line or a box plot.</span>
<span class="sd">        **kwargs (Any): Additional key word arguments, e.g. burn_in or dict_key, used in some specific plots but not</span>
<span class="sd">            applicable to all.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary with the following key/values:</span>
<span class="sd">            x_values (Union[np.ndarray, pd.arrays.DatetimeArray]): Array containing the x-values to plot.</span>
<span class="sd">            y_values (np.ndarray): Numpy array containing the y-values to use in plotting.</span>
<span class="sd">            dict_key (str): String key associated with this plot to be used in the figure_dict attribute of the</span>
<span class="sd">                Plot class.</span>
<span class="sd">            title_text (str): String title of the plot.</span>
<span class="sd">            x_label (str): String label of x-axis.</span>
<span class="sd">            y_label (str): String label of y-axis.</span>
<span class="sd">            plot_type (str): Type of plot which needs to be generated.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: When no specifics are defined for the inputted object to plot.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">ErrorModel</span><span class="p">):</span>
        <span class="n">y_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">object_to_plot</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
        <span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">y_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
            <span class="n">dict_key</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;dict_key&quot;</span><span class="p">,</span> <span class="s2">&quot;error_model_iterations&quot;</span><span class="p">)</span>
            <span class="n">title_text</span> <span class="o">=</span> <span class="s2">&quot;Estimated Error Model Values&quot;</span>
            <span class="n">x_label</span> <span class="o">=</span> <span class="n">MCMC_ITERATION_NUMBER_LITERAL</span>
            <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Estimated Error Model&lt;br&gt;Standard Deviation (ppm)&quot;</span>

        <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;box&quot;</span><span class="p">:</span>
            <span class="n">dict_key</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;dict_key&quot;</span><span class="p">,</span> <span class="s2">&quot;error_model_distributions&quot;</span><span class="p">)</span>
            <span class="n">title_text</span> <span class="o">=</span> <span class="s2">&quot;Distributions of Estimated Error Model Values After Burn-In&quot;</span>
            <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Sensor&quot;</span>
            <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Estimated Error Model&lt;br&gt;Standard Deviation (ppm)&quot;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only line and box are allowed for the plot_type argument for ErrorModel&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;burn_in&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Burn in is not specified for the ErrorModel plot, are you sure this is correct?&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">PerSensor</span><span class="p">):</span>
        <span class="n">offset_sensor_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span>
        <span class="n">y_values</span> <span class="o">=</span> <span class="n">object_to_plot</span><span class="o">.</span><span class="n">offset</span>
        <span class="n">nan_row</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">y_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">nan_row</span><span class="p">,</span> <span class="n">y_values</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">y_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
            <span class="n">dict_key</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;dict_key&quot;</span><span class="p">,</span> <span class="s2">&quot;offset_iterations&quot;</span><span class="p">)</span>
            <span class="n">title_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Estimated Value of Offset w.r.t. </span><span class="si">{</span><span class="n">offset_sensor_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">x_label</span> <span class="o">=</span> <span class="n">MCMC_ITERATION_NUMBER_LITERAL</span>
            <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Estimated Offset&lt;br&gt;Value (ppm)&quot;</span>

        <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;box&quot;</span><span class="p">:</span>
            <span class="n">dict_key</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;dict_key&quot;</span><span class="p">,</span> <span class="s2">&quot;offset_distributions&quot;</span><span class="p">)</span>
            <span class="n">title_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Distributions of Estimated Offset Values w.r.t. </span><span class="si">{</span><span class="n">offset_sensor_name</span><span class="si">}</span><span class="s2"> After Burn-In&quot;</span>
            <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Sensor&quot;</span>
            <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Estimated Offset&lt;br&gt;Value (ppm)&quot;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only line and box are allowed for the plot_type argument for PerSensor OffsetModel&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;burn_in&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Burn in is not specified for the PerSensor OffsetModel plot, are you sure this is correct?&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_to_plot</span><span class="p">,</span> <span class="n">MCMC</span><span class="p">):</span>
        <span class="n">y_values</span> <span class="o">=</span> <span class="n">object_to_plot</span><span class="o">.</span><span class="n">store</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
        <span class="n">x_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sensor_object</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
        <span class="n">dict_key</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;dict_key&quot;</span><span class="p">,</span> <span class="s2">&quot;fitted_values&quot;</span><span class="p">)</span>
        <span class="n">title_text</span> <span class="o">=</span> <span class="s2">&quot;Observations and Predicted Model Values Against Time&quot;</span>
        <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Time&quot;</span>
        <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Concentration (ppm)&quot;</span>
        <span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;line&quot;</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No values to plot&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;x_values&quot;</span><span class="p">:</span> <span class="n">x_values</span><span class="p">,</span>
        <span class="s2">&quot;y_values&quot;</span><span class="p">:</span> <span class="n">y_values</span><span class="p">,</span>
        <span class="s2">&quot;dict_key&quot;</span><span class="p">:</span> <span class="n">dict_key</span><span class="p">,</span>
        <span class="s2">&quot;title_text&quot;</span><span class="p">:</span> <span class="n">title_text</span><span class="p">,</span>
        <span class="s2">&quot;x_label&quot;</span><span class="p">:</span> <span class="n">x_label</span><span class="p">,</span>
        <span class="s2">&quot;y_label&quot;</span><span class="p">:</span> <span class="n">y_label</span><span class="p">,</span>
        <span class="s2">&quot;plot_type&quot;</span><span class="p">:</span> <span class="n">plot_type</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyelq.plotting.plot.plot_single_scatter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_single_scatter</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plots a single scatter trace on the supplied figure object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fig</code>
            </td>
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure to add the trace to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_values</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="pandas.arrays.DatetimeArray">DatetimeArray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X values to plot</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_values</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array containing the y-values to use in plotting.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>RGB color string to use for this trace.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String name to show in the legend.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional key word arguments, e.g. burn_in, legend_group, show_legend, used in some specific
plots but not applicable to all.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>fig</code></td>            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure with the trace added to it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_single_scatter</span><span class="p">(</span>
    <span class="n">fig</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span>
    <span class="n">x_values</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">DatetimeArray</span><span class="p">],</span>
    <span class="n">y_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots a single scatter trace on the supplied figure object.</span>

<span class="sd">    Args:</span>
<span class="sd">        fig (go.Figure): Plotly figure to add the trace to.</span>
<span class="sd">        x_values (Union[np.ndarray, pd.arrays.DatetimeArray]): X values to plot</span>
<span class="sd">        y_values (np.ndarray): Numpy array containing the y-values to use in plotting.</span>
<span class="sd">        color (str): RGB color string to use for this trace.</span>
<span class="sd">        name (str): String name to show in the legend.</span>
<span class="sd">        **kwargs (Any): Additional key word arguments, e.g. burn_in, legend_group, show_legend, used in some specific</span>
<span class="sd">            plots but not applicable to all.</span>

<span class="sd">    Returns:</span>
<span class="sd">        fig (go.Figure): Plotly figure with the trace added to it.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">burn_in</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;burn_in&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">legend_group</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;legend_group&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">show_legend</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;show_legend&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">burn_in</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_values</span><span class="p">[:</span> <span class="n">burn_in</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_values</span><span class="p">[:</span> <span class="n">burn_in</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">lighter_rgb</span><span class="p">(</span><span class="n">color</span><span class="p">)},</span>
                <span class="n">legendgroup</span><span class="o">=</span><span class="n">legend_group</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_values</span><span class="p">[</span><span class="n">burn_in</span><span class="p">:],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y_values</span><span class="p">[</span><span class="n">burn_in</span><span class="p">:],</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">},</span>
            <span class="n">legendgroup</span><span class="o">=</span><span class="n">legend_group</span><span class="p">,</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="n">show_legend</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyelq.plotting.plot.plot_single_box" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_single_box</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">y_values</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plot a single box plot trace on the plot figure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fig</code>
            </td>
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure to add the trace to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_values</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array containing the y-values to use in plotting.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>RGB color string to use for this trace.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String name to show in the legend.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>fig</code></td>            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure with the trace added to it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_single_box</span><span class="p">(</span><span class="n">fig</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">y_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot a single box plot trace on the plot figure.</span>

<span class="sd">    Args:</span>
<span class="sd">        fig (go.Figure): Plotly figure to add the trace to.</span>
<span class="sd">        y_values (np.ndarray): Numpy array containing the y-values to use in plotting.</span>
<span class="sd">        color (str): RGB color string to use for this trace.</span>
<span class="sd">        name (str): String name to show in the legend.</span>

<span class="sd">    Returns:</span>
<span class="sd">        fig (go.Figure): Plotly figure with the trace added to it.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_values</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">legendgroup</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">}))</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyelq.plotting.plot.plot_polygons_on_map" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_polygons_on_map</span><span class="p">(</span><span class="n">polygons</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">opacity</span><span class="p">,</span> <span class="n">map_color_scale</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plot a set of polygons on a map.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>polygons</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="list">list</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array or list containing the polygons to plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array consistent with polygons containing the value which is
                 used in coloring the polygons on the map.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>opacity</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Float between 0 and 1 specifying the opacity of the polygon fill color.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>map_color_scale</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string which defines which plotly color scale.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional key word arguments which can be passed on the go.Choroplethmap object
(will override the default values as specified in this function)</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>trace</code></td>            <td>
                  <code><span title="plotly.graph_objects.Choroplethmap">Choroplethmap</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>go.Choroplethmap trace with the colored polygons which can be added to a go.Figure object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_polygons_on_map</span><span class="p">(</span>
    <span class="n">polygons</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">opacity</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">map_color_scale</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Choroplethmap</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot a set of polygons on a map.</span>

<span class="sd">    Args:</span>
<span class="sd">        polygons (Union[np.ndarray, list]): Numpy array or list containing the polygons to plot.</span>
<span class="sd">        values (np.ndarray): Numpy array consistent with polygons containing the value which is</span>
<span class="sd">                             used in coloring the polygons on the map.</span>
<span class="sd">        opacity (float): Float between 0 and 1 specifying the opacity of the polygon fill color.</span>
<span class="sd">        map_color_scale (str): The string which defines which plotly color scale.</span>
<span class="sd">        **kwargs (Any): Additional key word arguments which can be passed on the go.Choroplethmap object</span>
<span class="sd">            (will override the default values as specified in this function)</span>

<span class="sd">    Returns:</span>
<span class="sd">        trace: go.Choroplethmap trace with the colored polygons which can be added to a go.Figure object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">polygon_id</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">feature_collection</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">([</span><span class="n">Feature</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">polygons</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">id_value</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">polygon_id</span><span class="p">])</span>
    <span class="n">text_box</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Polygon ID&lt;/b&gt;: </span><span class="si">{</span><span class="n">counter</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">&lt;br&gt;&lt;b&gt;Center (lon, lat)&lt;/b&gt;: &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">polygons</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">polygons</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&lt;br&gt;&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Value&lt;/b&gt;: </span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span><span class="si">:</span><span class="s2">f</span><span class="si">}</span><span class="s2">&lt;br&gt;&quot;</span>
        <span class="k">for</span> <span class="n">counter</span> <span class="ow">in</span> <span class="n">polygon_id</span>
    <span class="p">]</span>

    <span class="n">trace_options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;geojson&quot;</span><span class="p">:</span> <span class="n">feature_collection</span><span class="p">,</span>
        <span class="s2">&quot;featureidkey&quot;</span><span class="p">:</span> <span class="s2">&quot;id_value&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locations&quot;</span><span class="p">:</span> <span class="n">polygon_id</span><span class="p">,</span>
        <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">,</span>
        <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="n">opacity</span><span class="p">},</span>
        <span class="s2">&quot;hoverinfo&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text_box</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;colorscale&quot;</span><span class="p">:</span> <span class="n">map_color_scale</span><span class="p">,</span>
        <span class="s2">&quot;colorbar&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Values&quot;</span><span class="p">},</span>
        <span class="s2">&quot;showlegend&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">trace_options</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="n">trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Choroplethmap</span><span class="p">(</span><span class="o">**</span><span class="n">trace_options</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">trace</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyelq.plotting.plot.plot_regular_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_regular_grid</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">opacity</span><span class="p">,</span> <span class="n">map_color_scale</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;kg/hr&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Values&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plots a regular grid of LLA data onto a map.</p>
<p>So long as the input array is regularly spaced, the value of the spacing is found. A set of rectangles are defined
where the centre of the rectangle is the LLA coordinate.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>coordinates</code>
            </td>
            <td>
                  <code>LLA object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A LLA coordinate object containing a set of locations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A set of values that correspond to locations specified in the coordinates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>opacity</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The opacity of the grid cells when they are plotted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>map_color_scale</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string which defines which plotly color scale should be used when plotting
the values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tolerance</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Absolute value above which the difference between values is considered significant.
                         Used to calculate the regular grid of coordinate values. Defaults to 1e-7.</p>
              </div>
            </td>
            <td>
                  <code>1e-07</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unit</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unit to be added to the colorscale. Defaults to kg/hr.</p>
              </div>
            </td>
            <td>
                  <code>&#39;kg/hr&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name for the trace to be used in the color bar as well</p>
              </div>
            </td>
            <td>
                  <code>&#39;Values&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>trace</code></td>            <td>
                  <code><span title="plotly.graph_objects.Choroplethmap">Choroplethmap</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Trace with the colored polygons which can be added to a go.Figure object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_regular_grid</span><span class="p">(</span>
    <span class="n">coordinates</span><span class="p">:</span> <span class="n">LLA</span><span class="p">,</span>
    <span class="n">values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">opacity</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">map_color_scale</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">,</span>
    <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;kg/hr&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Values&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Choroplethmap</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots a regular grid of LLA data onto a map.</span>

<span class="sd">    So long as the input array is regularly spaced, the value of the spacing is found. A set of rectangles are defined</span>
<span class="sd">    where the centre of the rectangle is the LLA coordinate.</span>

<span class="sd">    Args:</span>
<span class="sd">        coordinates (LLA object): A LLA coordinate object containing a set of locations.</span>
<span class="sd">        values (np.array): A set of values that correspond to locations specified in the coordinates.</span>
<span class="sd">        opacity (float): The opacity of the grid cells when they are plotted.</span>
<span class="sd">        map_color_scale (str): The string which defines which plotly color scale should be used when plotting</span>
<span class="sd">            the values.</span>
<span class="sd">        tolerance (float, optional): Absolute value above which the difference between values is considered significant.</span>
<span class="sd">                                     Used to calculate the regular grid of coordinate values. Defaults to 1e-7.</span>
<span class="sd">        unit (str, optional): The unit to be added to the colorscale. Defaults to kg/hr.</span>
<span class="sd">        name (str, optional): Name for the trace to be used in the color bar as well</span>

<span class="sd">    Returns:</span>
<span class="sd">        trace (go.Choroplethmap): Trace with the colored polygons which can be added to a go.Figure object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">gridsize_lat</span> <span class="o">=</span> <span class="n">is_regularly_spaced</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">gridsize_lon</span> <span class="o">=</span> <span class="n">is_regularly_spaced</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">)</span>

    <span class="n">polygons</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">geometry</span><span class="o">.</span><span class="n">box</span><span class="p">(</span>
            <span class="n">coordinates</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">gridsize_lon</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">coordinates</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">gridsize_lat</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">coordinates</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">gridsize_lon</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">coordinates</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">gridsize_lat</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">nof_observations</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">trace</span> <span class="o">=</span> <span class="n">plot_polygons_on_map</span><span class="p">(</span>
        <span class="n">polygons</span><span class="o">=</span><span class="n">polygons</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">colorbar</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;&lt;br&gt;&quot;</span> <span class="o">+</span> <span class="n">unit</span><span class="p">},</span>
        <span class="n">map_color_scale</span><span class="o">=</span><span class="n">map_color_scale</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">trace</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyelq.plotting.plot.plot_hexagonal_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_hexagonal_grid</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">opacity</span><span class="p">,</span> <span class="n">map_color_scale</span><span class="p">,</span> <span class="n">num_hexagons</span><span class="p">,</span> <span class="n">show_positions</span><span class="p">,</span> <span class="n">aggregate_function</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plots a set of values into hexagonal bins with respect to the location of the values.</p>
<p>Any data points that fall within the area of a hexagon are used to perform aggregation and bin the data.
See: https://plotly.com/python-api-reference/generated/plotly.figure_factory.create_hexbin_mapbox.html</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>coordinates</code>
            </td>
            <td>
                  <code>LLA object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A LLA coordinate object containing a set of locations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A set of values that correspond to locations specified in the coordinates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>opacity</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The opacity of the hexagons when they are plotted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>map_color_scale</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour scale for plotting values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_hexagons</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of hexagons which define the <em>horizontal</em> axis of the plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_positions</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A flag to determine whether the original data should be shown alongside
the binning hexagons.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>aggregate_function</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function which to apply on the data in each hexagonal bin to aggregate
the data and visualise the result.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.sum">sum</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A plotly go figure representing the data which was submitted to this function.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyelq/plotting/plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_hexagonal_grid</span><span class="p">(</span>
    <span class="n">coordinates</span><span class="p">:</span> <span class="n">LLA</span><span class="p">,</span>
    <span class="n">values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">opacity</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">map_color_scale</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">num_hexagons</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
    <span class="n">show_positions</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">aggregate_function</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots a set of values into hexagonal bins with respect to the location of the values.</span>

<span class="sd">    Any data points that fall within the area of a hexagon are used to perform aggregation and bin the data.</span>
<span class="sd">    See: https://plotly.com/python-api-reference/generated/plotly.figure_factory.create_hexbin_mapbox.html</span>

<span class="sd">    Args:</span>
<span class="sd">        coordinates (LLA object): A LLA coordinate object containing a set of locations.</span>
<span class="sd">        values (np.array): A set of values that correspond to locations specified in the coordinates.</span>
<span class="sd">        opacity (float): The opacity of the hexagons when they are plotted.</span>
<span class="sd">        map_color_scale (str): Colour scale for plotting values.</span>
<span class="sd">        num_hexagons (Union[int, None]): The number of hexagons which define the *horizontal* axis of the plot.</span>
<span class="sd">        show_positions (bool): A flag to determine whether the original data should be shown alongside</span>
<span class="sd">            the binning hexagons.</span>
<span class="sd">        aggregate_function (Callable, optional): Function which to apply on the data in each hexagonal bin to aggregate</span>
<span class="sd">            the data and visualise the result.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (go.Figure): A plotly go figure representing the data which was submitted to this function.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">num_hexagons</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">num_hexagons</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">longitude</span><span class="p">))</span> <span class="o">/</span> <span class="mf">0.25</span><span class="p">))</span>

    <span class="n">coordinates</span> <span class="o">=</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">to_lla</span><span class="p">()</span>

    <span class="n">hex_plot</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">create_hexbin_mapbox</span><span class="p">(</span>
        <span class="n">lat</span><span class="o">=</span><span class="n">coordinates</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
        <span class="n">lon</span><span class="o">=</span><span class="n">coordinates</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
        <span class="n">nx_hexagon</span><span class="o">=</span><span class="n">num_hexagons</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
        <span class="n">agg_func</span><span class="o">=</span><span class="n">aggregate_function</span><span class="p">,</span>
        <span class="n">color_continuous_scale</span><span class="o">=</span><span class="n">map_color_scale</span><span class="p">,</span>
        <span class="n">show_original_data</span><span class="o">=</span><span class="n">show_positions</span><span class="p">,</span>
        <span class="n">original_data_marker</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">},</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">hex_plot</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.instant", "navigation.tabs", "navigation.top", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": {"Pipelines": "pipelines"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>